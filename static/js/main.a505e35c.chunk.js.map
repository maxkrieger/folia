{"version":3,"sources":["calcifer/cards/turtle.svg","Data.ts","calcifer/CardClass.ts","calcifer/ThingCard.ts","calcifer/cards/Turtle.ts","calcifer/icons/TurtleIcon.tsx","calcifer/AttributeCard.ts","calcifer/cards/Rainbow.ts","calcifer/icons/RainbowIcon.tsx","calcifer/cards/PenFollow.ts","calcifer/icons/BrushIcon.tsx","calcifer/CardIndex.ts","calcifer/cards/Emitter.ts","calcifer/icons/EmitterIcon.tsx","calcifer/cards/Wavy.ts","calcifer/icons/SineIcon.tsx","Card.tsx","calcifer/env.ts","Canvas.tsx","App.tsx","useInterval.ts","serviceWorker.ts","index.tsx"],"names":["module","exports","createCard","name","x","y","template","instanceid","uniqid","color","hasParent","coords","isTemplate","angle","age","anyToCard","c","card","child","insertLeaf","findByID","id","undefined","deleteByID","shiftLeafX","leaf","dx","CARD_WIDTH","GUTTER_SIZE","putIn","cards","sourceID","childID","map","find","console","error","filter","isUnrelated","id1","id2","head1","head2","lift","removed","Math","random","depth","Card","this","Thing","startMillis","Setup","p","millis","setup","world","drawableChildren","cancelled","onDragOut","setOnDragOut","cb","getHeight","windowHeight","composite","Matter","Composite","create","label","Turtle","img","rotationInterval","rainbowMode","virtualCanvas","maxage","penMode","enable","rainbow","lastX","lastY","getEffect","nb","World","add","payload","Body","applyForce","bodies","clearInterval","rotate","bodyA","allBodies","bodyB","bodyAHeight","bounds","max","min","bodyAWidth","bodyBHeight","bodyBWidth","Constraint","pointA","pointB","length","damping","stiffness","push","setRotationInterval","window","setInterval","setAngularVelocity","randomGaussian","debugBounds","vertices","fill","beginShape","forEach","vert","vertex","endShape","CLOSE","pop","handlePen","position","colorMode","HSB","stroke","interval","strokeWeight","line","image","draw","cancel","Query","point","mouseX","mouseY","mouseIsPressed","F","Vector","setVelocity","angleMode","RADIANS","translate","tint","remove","loadImage","turtle","createGraphics","windowWidth","Bodies","circle","TurtleIcon","width","height","d","AttributeCard","Rainbow","RainbowIcon","viewBox","Pen","enableRainbow","BrushIcon","CardIndex","emitter","emitInterval","radius","count","ne","Emitter","bname","b","setPosition","rot","isSensor","pen","wavy","state","wavelength","sin","StaticCard","cardData","dropping","Icon","style","backgroundColor","display","justifyContent","border","alignItems","cursor","zIndex","Reactable","reactable","props","getRef","onSetCoords","ond","onLift","mousedown","allCards","isSingleton","selfcontain","left","top","opacity","transition","transform","boxSizing","touchAction","data-card-id","ref","onDrop","React","setDropping","setMousedown","isHead","dropzone","ondragenter","ondragleave","ondrop","relatedTarget","dataset","cardId","overlap","accept","draggableElement","draggable","inertia","onend","onmove","dy","modifiers","interact","restrictRect","restriction","document","body","onDown","onUp","CARD_HEIGHT","borderRadius","Env","mouse","mouseConstraint","canvas","engine","things","windowResized","resizeCanvas","constructed","construct","addThing","walls","thing","t","t2","createCanvas","Mouse","elt","mouseParams","constraint","angularStiffness","MouseConstraint","gravity","pixelRatio","pixelDensity","rectangle","isStatic","Engine","run","watchdog","PI","collideDog","wall","collides","flat","background","Canv","theref","addCard","sk","setSk","node","p5","e","thingToCard","sub","ps","Cl","Canvas","dropped","current","setAllCoords","setCoords","App","bottomY","allcards","innerHeight","Object","keys","index","innerWidth","useState","setState","callback","delay","savedCallback","useRef","useEffect","useInterval","prevState","found","dropDelete","deleted","key","parentID","findInAllByID","bottom","Boolean","location","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.a505e35c.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/turtle.c5498b74.svg\";","import { CARD_WIDTH, GUTTER_SIZE } from \"./Card\";\nimport Thing from \"./calcifer/ThingCard\";\nimport uniqid from \"uniqid\";\nimport Card from \"./calcifer/CardClass\";\n\nexport interface ICoords {\n  x: number;\n  y: number;\n}\nexport interface C {\n  name: string;\n  instanceid: string;\n  color: string;\n  child?: C;\n  hasParent: boolean;\n  coords: ICoords;\n  isTemplate: boolean;\n  angle: number;\n  age: number;\n}\nexport const createCard = (\n  name: string,\n  x: number,\n  y: number,\n  template = false\n): C => ({\n  name,\n  instanceid: uniqid(\"card-\"),\n  // color: \"#\" + (0x1000000 + Math.random() * 0xffffff).toString(16).substr(1, 6),\n  color: \"#000000\",\n  hasParent: false,\n  coords: { x, y },\n  isTemplate: template,\n  angle: 0,\n  age: 0\n});\n\nexport const thingToCard = (t: Thing) => {\n  const card = createCard(\n    t.name,\n    t.composite.bodies[0].position.x,\n    t.composite.bodies[0].position.y\n  );\n  if (t.child) {\n    return insertLeaf(card, anyToCard(t.child));\n  }\n  return card;\n};\n\nexport const anyToCard = (c: Card): C => {\n  const card = createCard(c.name, 0, 0);\n  if (c.child) {\n    return insertLeaf(card, anyToCard(c.child));\n  }\n  return card;\n};\n\nexport const setCoords = (dy: number, dx: number, id: string, card: C): C =>\n  card.instanceid === id\n    ? {\n        ...card,\n        coords: { x: card.coords.x + dx, y: card.coords.y + dy },\n        age: 0,\n        isTemplate: false,\n        child: card.child\n          ? setCoords(dy, dx, card.child.instanceid, card.child)\n          : card.child\n      }\n    : card.child\n    ? { ...card, child: setCoords(dy, dx, id, card.child) }\n    : card;\n\nexport const findByID = (id: string, card: C): C | undefined =>\n  card.instanceid === id\n    ? card\n    : card.child\n    ? findByID(id, card.child)\n    : undefined;\n\nexport const deleteByID = (id: string, card: C): C | undefined =>\n  card.instanceid === id\n    ? undefined\n    : card.child\n    ? { ...card, child: deleteByID(id, card.child) }\n    : card;\n\nexport const findInAllByID = (id: string, cards: C[]): C => {\n  const found = cards\n    .map((card: C) => findByID(id, card))\n    .find((c: C | undefined) => c !== undefined);\n  if (found === undefined) {\n    console.error(`Cannot find card ${id}`);\n    //@ts-ignore\n    return;\n  }\n  return found;\n};\n\nexport const dropDelete = (id: string, cards: C[]): [C, C[]] => {\n  const found = cards\n    .map((card: C) => findByID(id, card))\n    .find((c: C | undefined) => c !== undefined);\n  if (found === undefined) {\n    console.error(`Cannot find card ${id}`);\n    return [cards[0], cards];\n  }\n  const deleted = cards\n    .map((card: C) => deleteByID(id, card))\n    .filter((c: C | undefined) => c !== undefined);\n  return [found, deleted as C[]];\n};\n\nexport const shiftLeafX = (leaf: C, x: number, dx: number, y: number): C => ({\n  ...leaf,\n  hasParent: true,\n  coords: { y, x },\n  child: leaf.child ? shiftLeafX(leaf.child, x + dx, dx, y) : undefined\n});\n\nexport const insertLeaf = (card: C, leaf: C): C =>\n  card.child === undefined\n    ? {\n        ...card,\n        age: 0,\n        child: shiftLeafX(\n          leaf,\n          card.coords.x + CARD_WIDTH + GUTTER_SIZE,\n          CARD_WIDTH + GUTTER_SIZE,\n          card.coords.y\n        )\n      }\n    : { ...card, child: insertLeaf(card.child, leaf) };\n\nexport const putIn = (cards: C[], sourceID: string, childID: string): C[] => {\n  const leaf = cards\n    .map((c: C) => findByID(childID, c))\n    .find((c: C | undefined) => c !== undefined);\n  if (leaf === undefined) {\n    console.error(`ASSERT: cannot find child by ID ${childID}`);\n    return cards;\n  }\n  return (cards\n    .map((card: C) => deleteByID(childID, card))\n    .filter((card: C | undefined) => card !== undefined) as C[]).map(\n    (card: C) => {\n      if (findByID(sourceID, card) !== undefined) {\n        return insertLeaf(card, leaf);\n      } else {\n        return card;\n      }\n    }\n  );\n};\n\nexport const isUnrelated = (cards: C[], id1: string, id2: string): boolean => {\n  const head1 = cards\n    .map((c: C) => findByID(id1, c))\n    .find((c: C | undefined) => c !== undefined);\n  const head2 = cards\n    .map((c: C) => findByID(id2, c))\n    .find((c: C | undefined) => c !== undefined);\n\n  if (head1 === undefined || head2 === undefined) {\n    return true;\n  }\n\n  return (\n    findByID(id1, head2) === undefined && findByID(id2, head1) === undefined\n  );\n};\n\nexport const lift = (cards: C[], id: string): C[] => {\n  const leaf = cards\n    .map((c: C) => findByID(id, c))\n    .find((c: C | undefined) => c !== undefined);\n\n  if (leaf === undefined) {\n    console.error(`ASSERT: cannot find ID ${id}`);\n    return cards;\n  }\n  const removed = cards\n    .map((card: C) => deleteByID(id, card))\n    .filter((card: C | undefined) => card !== undefined) as C[];\n  return [\n    ...removed,\n    { ...leaf, age: 0, hasParent: false, angle: Math.random() * 16 - 8 }\n  ];\n};\n\nexport const incrementAges = (cards: C[]) =>\n  cards\n    .map((card: C) => ({\n      ...card,\n      age: card.age + (card.isTemplate ? 0 : 1000)\n    }))\n    .filter((card: C) => card.isTemplate || card.age < 60000);\n\nexport const depth = (card: C): number =>\n  card.child ? depth(card.child) + 1 : 1;\n","import uniqid from \"uniqid\";\n\nexport default abstract class Card {\n  public name: string;\n  public id: string;\n  public child?: Card;\n\n  constructor(name: string) {\n    this.name = name;\n    this.id = uniqid(name);\n  }\n  public abstract cancel(): void;\n  public abstract getEffect(cb: (name: string, payload: any) => void): void;\n}\n","import Matter from \"matter-js\";\nimport Card from \"./CardClass\";\nimport p5 from \"p5\";\n\nexport default abstract class Thing extends Card {\n  constructor(name: string) {\n    super(name);\n    this.composite = Matter.Composite.create({ label: this.id });\n  }\n  protected startMillis = -1;\n\n  public Setup = () => {\n    this.startMillis = this.p.millis();\n    this.setup();\n  };\n  public abstract setup(): any;\n\n  public abstract draw(): any;\n\n  public p: p5;\n  public world: Matter.World;\n  public drawableChildren: Thing[] = [];\n  public child?: Card;\n  public x: number;\n  public y: number;\n  public cancelled = false;\n\n  public onDragOut: (t: Thing) => void = () => {};\n  public setOnDragOut = (cb: (t: Thing) => void) => {\n    this.onDragOut = cb;\n  };\n  public getHeight = () => {\n    return this.p.windowHeight * (2 / 3);\n  };\n\n  public composite: Matter.Composite;\n}\n","import * as p5 from \"p5\";\nimport Matter from \"matter-js\";\nimport Thing from \"../ThingCard\";\nimport Card from \"../CardClass\";\nimport turtle from \"./turtle.svg\";\n\nexport default class Turtle extends Thing {\n  public img: p5.Image;\n  public rotationInterval: number;\n  public rainbowMode = false;\n  public virtualCanvas: p5.Graphics;\n  public maxage = 180000;\n  public penMode: {\n    enable: boolean;\n    rainbow: boolean;\n    lastX: number;\n    lastY: number;\n  } = {\n    enable: false,\n    rainbow: false,\n    lastX: -1,\n    lastY: -1\n  };\n\n  public getEffect = (cb: (name: string, payload: any) => void) => {\n    const nb = new Turtle(this.p, this.world, this.x, this.y, this.child);\n    nb.Setup();\n    Matter.World.add(this.world, nb.composite);\n    if (nb.child) {\n      nb.child.getEffect((name: string, payload: any) => {\n        if (name === \"oscillate\") {\n          Matter.Body.applyForce(\n            nb.composite.bodies[0],\n            { x: 0, y: 0 },\n            {\n              x: 0,\n              y: 0.01 * payload\n            }\n          );\n        }\n        if (name === \"rainbow\") {\n          nb.rainbowMode = true;\n        }\n        if (name === \"pen\") {\n          nb.penMode = {\n            ...nb.penMode,\n            enable: true,\n            rainbow: payload.rainbow\n          };\n        }\n        if (name === \"wavy\") {\n          clearInterval(nb.rotationInterval);\n          Matter.Body.rotate(nb.composite.bodies[0], 0.05 * payload);\n        }\n        if (name === \"big\") {\n          //   Matter.Body.scale(\n          //     nb.composite.bodies[0],\n          //     payload / nb.radius,\n          //     payload / nb.radius\n          //   );\n          //   nb.radius = payload;\n        }\n        if (payload instanceof Thing) {\n          const bodyA = Matter.Composite.allBodies(nb.composite)[0];\n          const bodyB = Matter.Composite.allBodies(payload.composite)[0];\n          Matter.Composite.add(nb.composite, payload.composite);\n          const bodyAHeight = bodyA.bounds.max.y - bodyA.bounds.min.y,\n            bodyAWidth = bodyA.bounds.max.x - bodyA.bounds.min.x,\n            bodyBHeight = bodyB.bounds.max.y - bodyB.bounds.min.y,\n            bodyBWidth = bodyB.bounds.max.x - bodyB.bounds.min.x;\n          Matter.Composite.add(\n            nb.composite,\n            Matter.Constraint.create({\n              bodyA,\n              bodyB,\n              pointA: { x: bodyAWidth * 1, y: bodyAHeight * 0 },\n              pointB: {\n                x: bodyBWidth * -0.8,\n                y: bodyBHeight * 0\n              },\n              length: 8,\n              damping: 0.1,\n              stiffness: 0.1\n            })\n          );\n          nb.drawableChildren.push(payload);\n        }\n      });\n    }\n    cb(this.name, nb);\n  };\n\n  constructor(\n    p: p5,\n    world: Matter.World,\n\n    x: number = 0,\n    y: number = 0,\n    child?: Card\n  ) {\n    super(\"turtle\");\n    this.child = child;\n    this.x = x;\n    this.y = y;\n    this.world = world;\n    this.p = p;\n    this.img = this.p.loadImage(turtle);\n    this.virtualCanvas = this.p.createGraphics(\n      this.p.windowWidth,\n      this.getHeight()\n    );\n\n    Matter.Composite.add(\n      this.composite,\n      Matter.Bodies.circle(x, y, 25, {\n        angle: this.p.randomGaussian(0, 1)\n      })\n    );\n    this.setRotationInterval();\n  }\n\n  public setRotationInterval = () => {\n    this.rotationInterval = window.setInterval(() => {\n      Matter.Body.setAngularVelocity(\n        this.composite.bodies[0],\n        this.p.randomGaussian(0, 0.01)\n      );\n    }, this.p.randomGaussian(500, 100));\n  };\n\n  public setup = () => {};\n  public debugBounds = () => {\n    this.p.push();\n    const { vertices } = this.composite.bodies[0];\n    this.p.fill(255, 255, 255, 0.5);\n    this.p.beginShape();\n    vertices.forEach(vert => {\n      this.p.vertex(vert.x, vert.y);\n    });\n    this.p.endShape(this.p.CLOSE);\n    this.p.pop();\n  };\n  public handlePen = () => {\n    const { x, y } = this.composite.bodies[0].position;\n    if (this.penMode.lastX === -1) {\n      this.penMode.lastX = x;\n      this.penMode.lastY = y;\n    }\n    if (this.penMode.enable) {\n      const p = this.virtualCanvas;\n      p.push();\n      const interval = 5000;\n      p.colorMode(this.p.HSB, interval);\n      p.stroke(\"white\");\n      if (this.penMode.rainbow) {\n        p.stroke(\n          (this.p.millis() - this.startMillis) % interval,\n          interval / 2,\n          interval\n        );\n      }\n      p.strokeWeight(5);\n      p.line(this.penMode.lastX, this.penMode.lastY, x, y);\n      this.penMode.lastX = x;\n      this.penMode.lastY = y;\n      p.pop();\n      this.p.image(p, 0, 0);\n    }\n  };\n  public draw = () => {\n    if (this.p.millis() - this.startMillis >= this.maxage) {\n      this.cancel();\n    }\n    const mouseover = Matter.Query.point([this.composite.bodies[0]], {\n      x: this.p.mouseX,\n      y: this.p.mouseY\n    });\n    if (\n      mouseover.length > 0 &&\n      this.p.mouseIsPressed &&\n      this.composite.bodies[0].position.y >= this.getHeight() - 50\n    ) {\n      this.onDragOut(this);\n    }\n    // this.debugBounds();\n    const F = Matter.Vector.rotate(\n      Matter.Vector.create(0, -0.5),\n      this.composite.bodies[0].angle\n    );\n    Matter.Body.setVelocity(this.composite.bodies[0], F);\n\n    this.handlePen();\n    this.p.push();\n    this.p.angleMode(this.p.RADIANS);\n    this.p.translate(\n      this.composite.bodies[0].position.x,\n      this.composite.bodies[0].position.y\n    );\n    this.p.rotate(this.composite.bodies[0].angle);\n    if (this.rainbowMode) {\n      this.p.colorMode(this.p.HSB, 1000);\n      this.p.tint((this.p.millis() - this.startMillis) % 1000, 500, 1000);\n    }\n    this.p.image(this.img, -24, -20);\n    this.p.pop();\n    this.drawableChildren.forEach(child => {\n      child.draw();\n    });\n  };\n  public cancel = () => {\n    window.clearInterval(this.rotationInterval);\n    Matter.World.remove(this.world, this.composite.bodies[0], true);\n    if (this.child) {\n      this.child.cancel();\n    }\n  };\n}\n","import * as React from \"react\";\n\nconst TurtleIcon: React.FC = ({ color }: any) => (\n  <svg width=\"48\" height=\"60\">\n    <g>\n      <g>\n        <path\n          d=\"M38,16.9199219c0-0.8457031-0.3291016-1.6411133-0.9277344-2.2392578    c-1.2333984-1.2333984-3.2431641-1.234375-4.4785156,0l-1.1982422,1.1982422    c-0.6259766-0.3295898-1.3134766-0.609375-2.0615234-0.8349609V11c0-2.9404297-2.3925781-5.3330078-5.3339844-5.3330078    c-2.9404297,0-5.3330078,2.3925781-5.3330078,5.3330078v4.043457c-0.7490234,0.2255859-1.4360352,0.5053711-2.0620117,0.8354492    l-1.1982422-1.1982422c-1.234375-1.2353516-3.2441406-1.2353516-4.4785156,0    c-1.2348633,1.2348633-1.2348633,3.2436523,0,4.4785156l1.605957,1.6064453    c-0.2363281,0.8276367-0.3676758,1.722168-0.3676758,2.6923828c0,2.2333984,0.6176758,4.6181641,1.675293,6.8027344    l-1.4995117,1.4990234c-1.2348633,1.234375-1.2348633,3.2441406,0,4.4785156    c0.6171875,0.6171875,1.4282227,0.9257812,2.2392578,0.9257812s1.6220703-0.3085938,2.2392578-0.9257812l0.8525391-0.8525391    C19.2373047,36.75,21.0478516,37.6835938,23,37.9248047v1.2421875c0,1.7460938,1.4208984,3.1669922,3.1669922,3.1669922    c0.5527344,0,1-0.4472656,1-1s-0.4472656-1-1-1C25.5234375,40.3339844,25,39.8105469,25,39.1669922v-1.2421875    c1.9521484-0.2421875,3.7626953-1.1748047,5.3271484-2.5390625l0.8525391,0.8525391    c0.6171875,0.6171875,1.4287109,0.9257812,2.2392578,0.9257812s1.6220703-0.3085938,2.2392578-0.9257812    c1.234375-1.234375,1.234375-3.2441406,0-4.4785156l-1.5-1.5c1.0566406-2.1845703,1.6748047-4.5693359,1.6748047-6.8017578    c0-0.9697266-0.1308594-1.8642578-0.3671875-2.6914062l1.6064453-1.6069336C37.6708984,18.5615234,38,17.7661133,38,16.9199219z     M33.8330078,23.4580078c0,2.1318359-0.6484375,4.4404297-1.7382812,6.4902344    c-0.03125,0.0527344-0.0693359,0.1005859-0.0908203,0.1572266c-0.6464844,1.1816406-1.4394531,2.2675781-2.3417969,3.1796875    c-0.0039062,0.0039062-0.0087891,0.0048828-0.0126953,0.0087891c-0.0048828,0.0048828-0.0058594,0.0117188-0.0107422,0.0166016    C28.0244141,34.9345703,26.0732422,36,24,36c-2.0703125,0-4.0200195-1.0625-5.6328125-2.6835938    c-0.0068359-0.0068359-0.0087891-0.0166016-0.015625-0.0234375c-0.0053711-0.0058594-0.0126953-0.0068359-0.0180664-0.0117188    c-0.9018555-0.9140625-1.6958008-2-2.3417969-3.1826172c-0.0141602-0.0371094-0.0410156-0.0683594-0.0600586-0.1044922    c-1.1054688-2.0605469-1.7651367-4.3876953-1.7651367-6.5361328c0-5.8886719,5.3476562-7.1245117,9.8334961-7.1245117    C28.4853516,16.3334961,33.8330078,17.5693359,33.8330078,23.4580078z M20.6669922,11    c0-1.8378906,1.4951172-3.3330078,3.3330078-3.3330078S27.3339844,9.1621094,27.3339844,11v3.5922852    C26.3037109,14.4272461,25.1972656,14.3334961,24,14.3334961s-2.3027344,0.0932617-3.3330078,0.2587891V11z     M12.3422852,17.7451172c-0.4550781-0.4550781-0.4550781-1.1953125,0-1.6503906s1.1953125-0.4550781,1.6503906,0    l0.925293,0.925293c-0.6040039,0.5214844-1.1225586,1.1074219-1.53125,1.7700195L12.3422852,17.7451172z M13.7563477,34.8242188    c-0.4550781-0.4550781-0.4550781-1.1953125,0-1.6503906l1.0908203-1.0908203    c0.4282227,0.6689453,0.9052734,1.296875,1.4150391,1.8857422l-0.8554688,0.8554688    C14.9516602,35.2792969,14.2114258,35.2792969,13.7563477,34.8242188z M34.2441406,33.1738281    c0.4550781,0.4550781,0.4550781,1.1953125,0,1.6503906s-1.1953125,0.4550781-1.6503906,0l-0.8564453-0.8564453    c0.5097656-0.5888672,0.9873047-1.2167969,1.4150391-1.8857422L34.2441406,33.1738281z M35.6582031,17.7451172    l-1.0449219,1.0454102c-0.4091797-0.6625977-0.9267578-1.2485352-1.53125-1.7700195l0.9257812-0.925293    c0.4550781-0.4550781,1.1953125-0.4545898,1.6503906-0.0004883C35.8789062,16.3154297,36,16.6083984,36,16.9199219    S35.8789062,17.5244141,35.6582031,17.7451172z\"\n          fill={color}\n        />\n      </g>\n    </g>\n  </svg>\n);\nexport default TurtleIcon;\n","import Card from \"./CardClass\";\nexport default abstract class AttributeCard extends Card {}\n","import AttributeCard from \"../AttributeCard\";\nimport p5 from \"p5\";\nimport Card from \"../CardClass\";\n\nexport default class Rainbow extends AttributeCard {\n  constructor(\n    p: p5,\n    world: Matter.World,\n\n    x: number = 0,\n    y: number = 0,\n    child?: Card\n  ) {\n    super(\"rainbow\");\n    this.child = child;\n  }\n  public getEffect(cb: (name: string, payload: any) => void) {\n    if (this.child) {\n      this.child.getEffect(cb);\n    }\n    cb(\"rainbow\", null);\n  }\n  public cancel() {\n    if (this.child) {\n      this.child.cancel();\n    }\n  }\n}\n","import * as React from \"react\";\n\nconst RainbowIcon = ({ color }: any) => (\n  <svg viewBox=\"0 0 100 125\" width=\"50\">\n    <g>\n      <path\n        fill={color}\n        d=\"M77.385,72.358h-5.818C69.078,62.729,60.409,55.59,50,55.59s-19.078,7.14-21.566,16.769h-5.819   C25.213,59.617,36.506,50,50,50C63.494,50,74.787,59.617,77.385,72.358z M50,38.821c-19.678,0-36.01,14.601-38.728,33.537h5.693   C19.629,56.501,33.384,44.41,50,44.41c16.615,0,30.371,12.091,33.035,27.948h5.693C86.01,53.422,69.678,38.821,50,38.821z    M50,27.642c-25.852,0-47.205,19.597-50,44.717h5.671C8.428,50.306,27.206,33.231,50,33.231c22.795,0,41.572,17.074,44.328,39.127   H100C97.205,47.238,75.852,27.642,50,27.642z\"\n      />\n    </g>\n  </svg>\n);\nexport default RainbowIcon;\n","import AttributeCard from \"../AttributeCard\";\nimport Card from \"../CardClass\";\nimport p5 from \"p5\";\n\nexport default class Pen extends AttributeCard {\n  public enableRainbow = false;\n  constructor(\n    p: p5,\n    world: Matter.World,\n\n    x: number = 0,\n    y: number = 0,\n    child?: Card\n  ) {\n    super(\"pen\");\n    this.child = child;\n  }\n  public getEffect(cb: (name: string, payload: any) => void) {\n    if (this.child) {\n      this.child.getEffect((name, payload) => {\n        if (name === \"rainbow\") {\n          this.enableRainbow = true;\n          cb(\"pen\", { rainbow: true });\n        } else {\n          cb(name, payload);\n          cb(\"pen\", { rainbow: this.enableRainbow });\n        }\n      });\n    } else {\n      cb(\"pen\", { rainbow: false });\n    }\n  }\n  public cancel() {\n    if (this.child) {\n      this.child.cancel();\n    }\n  }\n}\n","import * as React from \"react\";\nconst BrushIcon = ({ color }: any) => (\n  <svg viewBox=\"0 0 24 30\" width=\"36\">\n    <g>\n      <path\n        d=\"M3.5,17.2c-0.6,0.6-0.8,1.3-1.1,2c-0.3,1-0.6,1.8-1.9,2.2c-0.3,0.1-0.4,0.4-0.4,0.6c0,0.3,0.2,0.5,0.5,0.6   c1,0.3,1.9,0.4,2.8,0.4c2.1,0,3.6-0.7,4.4-1.5c0.6-0.6,0.9-1.3,0.9-2.1s-0.3-1.6-0.9-2.1C6.6,16,4.6,16,3.5,17.2z M6.8,20.5   c-0.7,0.7-2.2,1.3-4.3,1.1c0.6-0.6,0.9-1.4,1.1-2.1C3.8,19,4,18.4,4.4,18.1c0,0,0,0,0,0c0.7-0.7,1.8-0.7,2.5,0   c0.3,0.3,0.5,0.8,0.5,1.2C7.3,19.8,7.2,20.2,6.8,20.5z\"\n        fill={color}\n      />\n      <path\n        d=\"M23.7,1.3c-0.5-0.5-1-1-8.4,5c-3.4,2.8-7,6-7.5,6.5c-0.6,0.6-0.9,1.3-0.9,2.1c0,0.8,0.3,1.6,0.9,2.1   C8.4,17.7,9.2,18,9.9,18c0.8,0,1.6-0.3,2.1-0.9c0.5-0.5,3.7-4.1,6.5-7.5C24.7,2.3,24.2,1.7,23.7,1.3z M8.7,16.2   c-0.3-0.3-0.5-0.8-0.5-1.2c0-0.5,0.2-0.9,0.5-1.2c0.1-0.1,0.3-0.3,0.5-0.4c0.9,0.6,1.8,1.5,2.4,2.4c-0.2,0.2-0.3,0.4-0.4,0.5   C10.5,16.9,9.4,16.9,8.7,16.2z M12.5,14.8c-0.6-0.9-1.5-1.7-2.3-2.3c3.1-2.7,9.6-8.3,12.1-9.7C20.8,5.2,15.2,11.7,12.5,14.8z\"\n        fill={color}\n      />\n    </g>\n  </svg>\n);\nexport default BrushIcon;\n","import Turtle from \"./cards/Turtle\";\n// import Ball from \"./cards/Particle\";\n// import Duck from \"./icons/Duck\";\nimport TurtleIcon from \"./icons/TurtleIcon\";\nimport Rainbow from \"./cards/Rainbow\";\nimport RainbowIcon from \"./icons/RainbowIcon\";\nimport Pen from \"./cards/PenFollow\";\nimport BrushIcon from \"./icons/BrushIcon\";\nimport Emitter from \"./cards/Emitter\";\nimport EmitterIcon from \"./icons/EmitterIcon\";\nimport Wavy from \"./cards/Wavy\";\nimport SineIcon from \"./icons/SineIcon\";\n\nconst CardIndex = {\n  turtle: [Turtle, TurtleIcon],\n  // ball: [Ball, Duck],\n  emitter: [Emitter, EmitterIcon],\n  rainbow: [Rainbow, RainbowIcon],\n  pen: [Pen, BrushIcon],\n  wavy: [Wavy, SineIcon]\n} as any;\nexport default CardIndex;\n","import Thing from \"../ThingCard\";\nimport p5 from \"p5\";\nimport Card from \"../CardClass\";\nimport Matter from \"matter-js\";\n\nexport default class Emitter extends Thing {\n  public emitInterval: number;\n  public radius = 10;\n  public count = 20;\n  public maxage = 50000;\n  constructor(\n    p: p5,\n    world: Matter.World,\n\n    x: number = 0,\n    y: number = 0,\n    child?: Card\n  ) {\n    super(\"emitter\");\n    this.x = x;\n    this.y = y;\n    this.p = p;\n    this.world = world;\n    this.child = child;\n    Matter.Composite.add(\n      this.composite,\n      Matter.Bodies.circle(x, y, this.radius / 2, {\n        isSensor: true\n      })\n    );\n  }\n  public cancel = () => {\n    this.cancelled = true;\n    window.clearInterval(this.emitInterval);\n    this.drawableChildren.forEach(child => {\n      Matter.Composite.remove(child.world, child.composite.bodies[0]);\n    });\n    if (this.child) {\n      this.child.cancel();\n    }\n    this.drawableChildren = [];\n    Matter.Composite.remove(this.world, this.composite.bodies[0]);\n  };\n  public getEffect = (cb: (name: string, payload: any) => void) => {\n    const ne = new Emitter(this.p, this.world, this.x, this.y, this.child);\n    ne.Setup();\n    if (ne.child && ne.child.name === this.name) {\n      ne.child.getEffect(cb);\n      return;\n    }\n    Matter.World.add(this.world, ne.composite);\n    if (ne.child) {\n      ne.child.getEffect((name: string, payload: any) => {\n        if (payload instanceof Thing) {\n          ne.emitInterval = window.setInterval(() => {\n            // if (ne.drawableChildren.length > 20) {\n            //   ne.drawableChildren[0].cancel();\n            //   Matter.Composite.remove(ne.composite, ne.composite.composites[1]);\n            //   ne.drawableChildren.shift();\n            // }\n            if (ne.count > 0) {\n              ne.count--;\n              const { x, y } = ne.composite.bodies[0].position;\n              payload.getEffect((bname, b) => {\n                Matter.Body.setPosition(b.composite.bodies[0], { x, y });\n                const rot = this.p.randomGaussian(0, 1);\n\n                Matter.Body.applyForce(\n                  b.composite.bodies[0],\n                  {\n                    x: b.composite.bodies[0].position.x,\n                    y: b.composite.bodies[0].position.y\n                  },\n                  Matter.Vector.rotate({ x: 0, y: -0.1 }, rot)\n                );\n                Matter.Body.rotate(b.composite.bodies[0], rot);\n                Matter.Composite.add(ne.composite, b.composite);\n                ne.drawableChildren.push(b);\n              });\n            }\n          }, this.p.randomGaussian(900, 100));\n        }\n      });\n    }\n\n    cb(this.name, ne);\n  };\n  public draw = () => {\n    const mouseover = Matter.Query.point([this.composite.bodies[0]], {\n      x: this.p.mouseX,\n      y: this.p.mouseY\n    });\n    if (\n      mouseover.length > 0 &&\n      this.p.mouseIsPressed &&\n      this.composite.bodies[0].position.y >= this.getHeight() - 50\n    ) {\n      this.onDragOut(this);\n    }\n    if (this.p.millis() - this.startMillis >= this.maxage) {\n      this.cancel();\n    }\n    this.p.push();\n    this.p.fill(\"white\");\n    this.p.circle(\n      this.composite.bodies[0].position.x,\n      this.composite.bodies[0].position.y,\n      this.radius\n    );\n    this.p.pop();\n    this.drawableChildren.forEach(child => {\n      child.draw();\n    });\n  };\n  public setup = () => {};\n}\n","import * as React from \"react\";\nconst EmitterIcon = ({ color }: any) => (\n  <svg viewBox=\"0 0 108.777 140.71\" width=\"50\">\n    <g>\n      <g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M54.388,86.653c-13.364,0-24.237-10.873-24.237-24.236c0-13.365,10.873-24.238,24.237-24.238     c13.365,0,24.238,10.873,24.238,24.238C78.626,75.78,67.753,86.653,54.388,86.653z M54.388,43.179     c-10.607,0-19.237,8.63-19.237,19.238c0,10.607,8.63,19.236,19.237,19.236s19.238-8.629,19.238-19.236     C73.626,51.809,64.995,43.179,54.388,43.179z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M54.389,43.179c-1.381,0-2.5-1.119-2.5-2.5V2.5c0-1.381,1.119-2.5,2.5-2.5s2.5,1.119,2.5,2.5v38.179     C56.889,42.06,55.77,43.179,54.389,43.179z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M43.522,46.091c-0.864,0-1.704-0.447-2.167-1.25l-16.95-29.359c-0.69-1.195-0.281-2.725,0.915-3.414     c1.196-0.693,2.725-0.281,3.415,0.914l16.95,29.359c0.69,1.195,0.28,2.725-0.915,3.415     C44.377,45.983,43.946,46.091,43.522,46.091z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M35.562,54.048c-0.424,0-0.854-0.108-1.247-0.336L15.49,42.844c-1.196-0.69-1.605-2.22-0.915-3.415     c0.689-1.195,2.218-1.607,3.415-0.915l18.824,10.868c1.195,0.69,1.605,2.219,0.915,3.415     C37.267,53.599,36.426,54.048,35.562,54.048z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M19.031,64.915c-1.381,0-2.5-1.119-2.5-2.5s1.119-2.5,2.5-2.5h13.621c1.381,0,2.5,1.119,2.5,2.5     s-1.119,2.5-2.5,2.5H19.031z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M2.503,94.874c-0.864,0-1.704-0.447-2.167-1.25c-0.69-1.195-0.281-2.724,0.915-3.416l33.063-19.09     c1.194-0.691,2.725-0.281,3.415,0.915s0.28,2.725-0.915,3.415L3.751,94.538C3.357,94.766,2.927,94.874,2.503,94.874z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M26.874,112.569c-0.424,0-0.854-0.109-1.247-0.336c-1.196-0.691-1.605-2.219-0.915-3.416l16.644-28.828     c0.689-1.195,2.218-1.607,3.415-0.915c1.195,0.69,1.605,2.22,0.915,3.415l-16.644,28.828     C28.579,112.12,27.738,112.569,26.874,112.569z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M54.39,110.141c-1.381,0-2.5-1.119-2.5-2.5l-0.001-23.49c0-1.381,1.119-2.5,2.5-2.5     c1.38,0,2.5,1.119,2.5,2.5l0.001,23.49C56.89,109.022,55.771,110.141,54.39,110.141z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M81.116,111.206c-0.864,0-1.704-0.449-2.167-1.252L63.092,82.489c-0.69-1.195-0.281-2.725,0.915-3.415     c1.195-0.692,2.725-0.281,3.415,0.915l15.857,27.464c0.69,1.197,0.28,2.725-0.915,3.416     C81.971,111.096,81.54,111.206,81.116,111.206z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M84.665,82.397c-0.424,0-0.854-0.108-1.247-0.336l-11.455-6.613c-1.196-0.69-1.605-2.219-0.915-3.415     c0.688-1.195,2.218-1.607,3.415-0.915l11.455,6.613c1.195,0.69,1.605,2.219,0.915,3.415     C86.37,81.948,85.529,82.397,84.665,82.397z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M76.125,64.915c-1.381,0-2.5-1.119-2.5-2.5s1.119-2.5,2.5-2.5h29.055c1.381,0,2.5,1.119,2.5,2.5     s-1.119,2.5-2.5,2.5H76.125z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M73.215,54.048c-0.864,0-1.704-0.449-2.167-1.251c-0.69-1.196-0.281-2.725,0.915-3.415l33.064-19.091     c1.196-0.69,2.725-0.28,3.415,0.915s0.28,2.725-0.915,3.415L74.463,53.712C74.069,53.938,73.639,54.048,73.215,54.048z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M65.254,46.091c-0.424,0-0.854-0.107-1.247-0.335c-1.196-0.69-1.605-2.22-0.915-3.415l12.701-22.002     c0.689-1.195,2.217-1.607,3.415-0.914c1.195,0.689,1.605,2.219,0.915,3.414L67.422,44.841     C66.959,45.643,66.118,46.091,65.254,46.091z\"\n          />\n        </g>\n      </g>\n    </g>\n  </svg>\n);\nexport default EmitterIcon;\n","import AttributeCard from \"../AttributeCard\";\nimport p5 from \"p5\";\nimport Card from \"../CardClass\";\nexport default class Wavy extends AttributeCard {\n  public interval: number;\n  public state = 0;\n  public p: p5;\n  constructor(\n    p: p5,\n    world: Matter.World,\n\n    x: number = 0,\n    y: number = 0,\n    child?: Card\n  ) {\n    super(\"wavy\");\n    this.child = child;\n    this.p = p;\n  }\n  public getEffect(cb: (name: string, payload: any) => void) {\n    if (this.child) {\n      this.child.getEffect(cb);\n    }\n    const wavelength = 0.5 + this.p.randomGaussian(0, 0.2);\n    this.interval = window.setInterval(() => {\n      this.state += 0.1;\n      cb(\"wavy\", Math.sin(wavelength * this.state));\n    }, 50);\n  }\n  public cancel() {\n    window.clearInterval(this.interval);\n    if (this.child) {\n      this.child.cancel();\n    }\n  }\n}\n","import * as React from \"react\";\nconst SineIcon = ({ color }: any) => (\n  <svg viewBox=\"0 0 100 125\" width=\"50\">\n    <path d=\"M74.46,86q-.44,0-.87,0c-7.3-.6-13-8.67-16.57-15.33-2.26-4.26-4.19-10.54-6.25-17.18-4.55-14.72-10.21-33-22-36.79C19.51,13.68,13,24.2,8.4,33.69A139.25,139.25,0,0,0,2,50.21a1,1,0,0,1-2-.66A140.86,140.86,0,0,1,6.55,32.79c3.2-6.58,10.71-22,22.84-18.14C42.22,18.72,47.81,36.82,52.74,52.8c2,6.55,3.93,12.74,6.1,16.83,3.29,6.21,8.54,13.72,14.92,14.24,3.18.26,6.42-1.29,9.65-4.61,7-7.25,10.72-18.21,13.68-27,.28-.84.58-1.77.9-2.77a1,1,0,1,1,2,.62c-.32,1-.62,1.95-.91,2.8-2.87,8.53-6.8,20.22-14.16,27.8C81.49,84.19,78,86,74.46,86Z\" />\n  </svg>\n);\n\nexport default SineIcon;\n","import * as React from \"react\";\nimport reactable from \"reactablejs\";\nimport { C, depth, shiftLeafX } from \"./Data\";\nimport interact from \"interactjs\";\nimport CardIndex from \"./calcifer/CardIndex\";\n\nexport const CARD_WIDTH = 165 / 2;\n\nexport const CARD_HEIGHT = 230 / 2;\n\nexport const GUTTER_SIZE = 10;\n\ninterface ISCProps {\n  getRef: any;\n  x: number;\n  y: number;\n  angle: number;\n  dropping: boolean;\n  cardData: C;\n  allCards: C[];\n  mousedown: boolean;\n  onSetCoords(dy: number, dx: number, id: string): void;\n  ond(parent: string, child: string): void;\n  onLift(id: string): void;\n  isUnrelated(isUnrelated: C[], id1: string, id2: string): boolean;\n}\n\nconst StaticCard: React.FC<any> = ({ cardData, dropping }: any) => {\n  const Icon = CardIndex[cardData.name][1];\n  return (\n    <div\n      style={{\n        width: CARD_WIDTH,\n        height: CARD_HEIGHT,\n        backgroundColor: dropping ? \"#6BCAFF\" : \"#FFFFFF\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        border: \"1px solid black\",\n        alignItems: \"center\",\n        cursor: \"grab\",\n        zIndex: 10\n      }}\n    >\n      <Icon color={cardData.color} />\n    </div>\n  );\n};\n\nconst SC: React.FC<ISCProps> = (props: ISCProps) => {\n  const {\n    getRef,\n    x,\n    y,\n    dropping,\n    cardData,\n    onSetCoords,\n    ond,\n    onLift,\n    mousedown,\n    isUnrelated,\n    allCards\n  } = props;\n\n  const c = <StaticCard cardData={cardData} dropping={dropping} />;\n  const isSingleton = cardData.child === undefined && !cardData.hasParent;\n  const selfcontain = (\n    <div\n      style={{\n        position: \"absolute\",\n        left: x,\n        top: y,\n        opacity: mousedown ? 0.5 : 1,\n        transition: \"opacity 0.25s, transform 0.25s\",\n        transform: `rotate(${isSingleton ? cardData.angle : 0}deg)`,\n        boxSizing: \"border-box\",\n        touchAction: \"none\",\n        zIndex: mousedown ? 1000 : 10\n      }}\n      data-card-id={cardData.instanceid}\n      ref={getRef}\n    >\n      {c}\n    </div>\n  );\n  if (!cardData.child) {\n    return selfcontain;\n  }\n  const child = (\n    <Card\n      cardData={\n        mousedown\n          ? shiftLeafX(\n              cardData.child,\n              cardData.coords.x + CARD_WIDTH / 5,\n              CARD_WIDTH / 5,\n              cardData.coords.y\n            )\n          : cardData.child\n      }\n      allCards={allCards}\n      onSetCoords={onSetCoords}\n      onDrop={ond}\n      onLift={onLift}\n      isUnrelated={isUnrelated}\n    />\n  );\n  return (\n    <>\n      {selfcontain}\n      {child}\n    </>\n  );\n};\n\ninterface ICardProps {\n  cardData: C;\n  allCards: C[];\n  onSetCoords(dy: number, dx: number, id: string): void;\n  onDrop(parent: string, child: string): void;\n  onLift(id: string): void;\n  isUnrelated(cards: C[], id1: string, id2: string): boolean;\n}\n\nconst Reactable = reactable(SC);\n\nconst Card: React.FC<ICardProps> = ({\n  cardData,\n  onSetCoords,\n  onDrop,\n  onLift,\n  isUnrelated,\n  allCards\n}: ICardProps) => {\n  const [dropping, setDropping] = React.useState(false);\n\n  const [mousedown, setMousedown] = React.useState(false);\n  const isHead = cardData.child !== undefined && !cardData.hasParent;\n\n  // This doesn't actually help since reactable's a HOC\n  const dropzone = React.useMemo(\n    () => ({\n      ondragenter: () => setDropping(true),\n      ondragleave: () => setDropping(false),\n      ondrop: ({ relatedTarget }: any) => {\n        onDrop(cardData.instanceid, relatedTarget.dataset.cardId);\n        setDropping(false);\n      },\n      overlap: 0.1,\n      accept: ({ dropzone, draggableElement }: any) => {\n        if (draggableElement.dataset.cardId) {\n          return (\n            isUnrelated(\n              allCards,\n              cardData.instanceid,\n              draggableElement.dataset.cardId as string\n            ) && cardData.instanceid !== draggableElement.dataset.cardId\n          );\n        } else return false;\n      }\n    }),\n    [allCards, cardData.instanceid, isUnrelated, onDrop]\n  );\n\n  const c = (\n    <Reactable\n      draggable={\n        {\n          inertia: true,\n          onend: () => onLift(cardData.instanceid),\n          onmove: ({ dy, dx }: any) => onSetCoords(dy, dx, cardData.instanceid),\n          modifiers: [\n            interact.modifiers.restrictRect({\n              restriction: document.body\n            })\n          ]\n        } as any\n      }\n      dropzone={dropzone}\n      dropping={dropping}\n      onDown={() => {\n        setMousedown(true);\n      }}\n      onUp={() => {\n        setMousedown(false);\n      }}\n      mousedown={mousedown}\n      cardData={cardData}\n      onSetCoords={onSetCoords}\n      onLift={onLift}\n      ond={onDrop}\n      allCards={allCards}\n      isUnrelated={isUnrelated}\n      {...cardData.coords}\n    />\n  );\n  return (\n    <>\n      <div\n        style={{\n          display: isHead && !mousedown ? \"initial\" : \"none\",\n          position: \"absolute\",\n          width: depth(cardData) * (CARD_WIDTH + GUTTER_SIZE) + GUTTER_SIZE,\n          height: CARD_HEIGHT + 20,\n          left: cardData.coords.x - GUTTER_SIZE,\n          top: cardData.coords.y - GUTTER_SIZE,\n          backgroundColor: \"tan\",\n          borderRadius: \"10px\",\n          zIndex: 10\n        }}\n      />\n      {c}\n    </>\n  );\n};\n\nexport { Card, StaticCard };\n","import * as p5 from \"p5\";\nimport Matter from \"matter-js\";\nimport Thing from \"./ThingCard\";\nimport { C } from \"../Data\";\nimport CardIndex from \"./CardIndex\";\nimport Card from \"./CardClass\";\n\nconst WALL_SIZE = 70;\n\nexport default class Env {\n  public mouse: Matter.Mouse;\n  public mouseConstraint: Matter.MouseConstraint;\n  public canvas: p5.Renderer;\n  public p: p5;\n  public engine: Matter.Engine;\n  public onDragOut: (t: Thing) => void;\n  public rainbowMode = false;\n  public penMode: {\n    enable: boolean;\n    rainbow: boolean;\n    lastX: number;\n    lastY: number;\n  } = {\n    enable: false,\n    rainbow: false,\n    lastX: -1,\n    lastY: -1\n  };\n  public startMillis = 0;\n\n  public things: Thing[] = [];\n\n  constructor(p: p5, onDragOut: (t: Thing) => void) {\n    this.p = p;\n    this.p.setup = this.Setup;\n    this.p.windowResized = this.windowResized;\n    this.p.draw = this.draw;\n    this.engine = Matter.Engine.create();\n    this.onDragOut = onDragOut;\n    // this.p.preload = this.preload;\n  }\n  public windowResized = () => {\n    this.p.resizeCanvas(this.p.windowWidth, this.getHeight());\n  };\n  public onDrop = (card: C) => {\n    const constructed = this.construct(card);\n    if (constructed instanceof Thing) {\n      this.addThing(constructed);\n    } else {\n      constructed.getEffect((name, payload) => {\n        if (name === \"rainbow\") {\n          this.rainbowMode = !this.rainbowMode;\n        } else if (name === \"pen\") {\n          this.penMode = {\n            lastX: card.coords.x,\n            lastY: card.coords.y,\n            enable: true,\n            rainbow: payload.rainbow\n          };\n        }\n      });\n      // Env-wide attrs or x/y placeholder\n    }\n  };\n  public construct = (card: C): Card => {\n    // NOTE: coords.x/y are card specific\n    return new CardIndex[card.name][0](\n      this.p,\n      this.engine.world,\n      card.coords.x,\n      card.coords.y,\n      card.child ? this.construct(card.child) : undefined\n    );\n  };\n\n  public walls: Matter.Body[];\n  public addThing = (thing: Thing) => {\n    thing.Setup();\n    thing.getEffect((name, payload) => {\n      payload.setOnDragOut((t: Thing) => {\n        this.things = this.things.filter((t2: Thing) => t2.id !== t.id);\n        this.onDragOut(t);\n      });\n      this.things.push(payload);\n    });\n  };\n  public Setup = () => {\n    this.canvas = this.p.createCanvas(this.p.windowWidth, this.getHeight());\n    this.mouse = Matter.Mouse.create(this.canvas.elt);\n    const mouseParams = {\n      mouse: this.mouse,\n      constraint: {\n        stiffness: 0.1,\n        angularStiffness: 0.95\n      } as any\n    };\n    this.mouseConstraint = Matter.MouseConstraint.create(\n      this.engine,\n      mouseParams\n    );\n    this.engine.world.gravity.y = 0;\n\n    this.startMillis = this.p.millis();\n    this.mouseConstraint.mouse.pixelRatio = this.p.pixelDensity();\n    Matter.World.add(this.engine.world, this.mouseConstraint);\n    this.walls = [\n      Matter.Bodies.rectangle(\n        0,\n        this.getHeight() + WALL_SIZE,\n        this.p.windowWidth,\n        WALL_SIZE,\n        { isStatic: true }\n      ),\n      Matter.Bodies.rectangle(0, -WALL_SIZE, this.p.windowWidth, WALL_SIZE, {\n        isStatic: true\n      }),\n      Matter.Bodies.rectangle(-WALL_SIZE, 0, WALL_SIZE, this.getHeight(), {\n        isStatic: true\n      }),\n      Matter.Bodies.rectangle(\n        this.p.windowWidth,\n        0,\n        WALL_SIZE,\n        this.getHeight(),\n        {\n          isStatic: true\n        }\n      )\n    ];\n    Matter.World.add(this.engine.world, this.walls);\n    Matter.Engine.run(this.engine);\n  };\n  public watchdog = () => {\n    Matter.Composite.allBodies(this.engine.world).forEach(body => {\n      const { x, y } = body.position;\n      if (!body.isStatic) {\n        if (x < 0) {\n          body.position.x = 0;\n          Matter.Body.rotate(body, Math.PI);\n        } else if (x > this.p.windowWidth) {\n          body.position.x = this.p.windowWidth - 50;\n          Matter.Body.rotate(body, Math.PI);\n        } else if (y < 0) {\n          body.position.y = 0;\n          Matter.Body.rotate(body, Math.PI);\n        } else if (y > this.getHeight()) {\n          body.position.y = this.getHeight() - 50;\n          Matter.Body.rotate(body, Math.PI);\n        }\n      }\n    });\n  };\n  public collideDog = () => {\n    const colls = this.walls.map((wall: any) =>\n      (Matter.Query as any).collides(\n        wall,\n        Matter.Composite.allBodies(this.engine.world)\n      )\n    );\n    const fl = colls.flat();\n    fl.forEach(({ bodyB, bodyA }: any) => {\n      if (!bodyB.isStatic) {\n        Matter.Body.rotate(bodyB, Math.PI);\n      }\n      if (!bodyA.isStatic) {\n        Matter.Body.rotate(bodyA, Math.PI);\n      }\n    });\n  };\n  public getHeight = () => {\n    return this.p.windowHeight * (2 / 3);\n  };\n  public draw = () => {\n    // Matter.Engine.update(this.engine);\n    this.things = this.things.filter(thing => !thing.cancelled);\n    this.things.forEach(this.watchdog);\n    this.collideDog();\n\n    if (this.rainbowMode) {\n      this.p.colorMode(this.p.HSB, 1000);\n      this.p.background((this.p.millis() - this.startMillis) % 1000, 500, 400);\n    } else {\n      this.p.background(\"#322931\");\n    }\n    if (this.penMode.enable) {\n      const interval = 5000;\n      this.p.push();\n      this.p.colorMode(this.p.HSB, interval);\n      this.p.fill(\"white\");\n      if (this.penMode.rainbow) {\n        this.p.fill(\n          (this.p.millis() - this.startMillis) % interval,\n          interval / 2,\n          interval\n        );\n      }\n      this.p.circle(this.penMode.lastX, this.penMode.lastY, 10);\n      this.p.pop();\n    }\n    this.things.forEach(t => {\n      t.draw();\n    });\n  };\n}\n","import * as React from \"react\";\nimport p5 from \"p5\";\nimport Env from \"./calcifer/env\";\nimport reactable from \"reactablejs\";\nimport { C, thingToCard } from \"./Data\";\nimport { CARD_WIDTH, CARD_HEIGHT } from \"./Card\";\nimport Thing from \"./calcifer/ThingCard\";\n\nconst Canv = ({ getRef, theref, addCard }: any) => {\n  const [sk, setSk] = React.useState<any>(null);\n  React.useImperativeHandle(theref, () => ({\n    onDrop(card: C) {\n      sk.onDrop({\n        ...card,\n        coords: {\n          x: card.coords.x + CARD_WIDTH / 2,\n          y: card.coords.y + CARD_HEIGHT / 2\n        }\n      });\n    }\n  }));\n  const ref = React.useCallback((node: any) => {\n    if (node !== null) {\n      const sketch = (p: p5) => {\n        const e = new Env(p, (t: Thing) => {\n          addCard(thingToCard(t));\n        });\n        setSk(e);\n        return e;\n      };\n      new p5(sketch, node);\n    }\n    // Im sorry\n    // eslint-disable-next-line\n  }, []);\n\n  return (\n    <div ref={getRef}>\n      <div ref={ref} />\n    </div>\n  );\n};\n\n// use `as any` to coerce\nconst Reactable = React.forwardRef((props: any, ref: any) => {\n  const sub: React.FC = React.useMemo(\n    () => (ps: any) => <Canv ref={ref} {...ps} />,\n    [ref]\n  );\n  const Cl = React.useMemo(() => reactable(sub), [sub]);\n  return <Cl {...props} />;\n});\n\ninterface IProps {\n  dropped(id: string, cb: (card: C) => void): void;\n  addCard(card: C): void;\n}\n\nconst Canvas: React.FC<IProps> = ({ dropped, addCard }: IProps) => {\n  const ref = React.useRef<any>();\n  return (\n    <Reactable\n      dropzone={\n        {\n          accept: ({ dropzone, draggableElement }) => {\n            if (draggableElement.dataset.cardId) {\n              return true;\n            } else return false;\n          },\n          ondrop: ({ relatedTarget }) => {\n            dropped(relatedTarget.dataset.cardId, (c: C) => {\n              if (ref && ref.current) {\n                ref.current.onDrop(c);\n              }\n            });\n          },\n          overlap: 0.5\n        } as Interact.DropzoneOptions\n      }\n      theref={ref}\n      addCard={addCard}\n    />\n  );\n};\n\nexport default Canvas;\n","import React, { useState } from \"react\";\nimport { Card, CARD_WIDTH, CARD_HEIGHT, GUTTER_SIZE } from \"./Card\";\nimport {\n  C,\n  setCoords,\n  putIn,\n  lift,\n  isUnrelated,\n  dropDelete,\n  findInAllByID,\n  createCard,\n  incrementAges\n} from \"./Data\";\nimport Canvas from \"./Canvas\";\nimport CardIndex from \"./calcifer/CardIndex\";\nimport useInterval from \"./useInterval\";\n\nexport const CARD_PALETTE_OFFSET = 50;\n\ninterface IState {\n  cards: C[];\n}\n\nconst setAllCoords = (dy: number, dx: number, id: string, cards: C[]) =>\n  cards.map((card: C) => setCoords(dy, dx, id, card));\n\nconst allCards = (bottomY: number) =>\n  Object.keys(CardIndex).map((name: string, index: number) =>\n    createCard(\n      name,\n      window.innerWidth / 2 -\n        ((CARD_WIDTH + GUTTER_SIZE) * Object.keys(CardIndex).length) / 2 +\n        (CARD_WIDTH + GUTTER_SIZE) * index +\n        GUTTER_SIZE,\n      bottomY,\n      true\n    )\n  );\n\nconst App: React.FC = () => {\n  const allcards = allCards(\n    window.innerHeight - CARD_HEIGHT - GUTTER_SIZE - CARD_PALETTE_OFFSET\n  );\n  const [state, setState] = useState<IState>({\n    cards: allcards\n  });\n\n  useInterval(() => {\n    setState({ ...state, cards: incrementAges(state.cards) });\n  }, 1000);\n\n  return (\n    <div\n      style={{ width: \"100%\", height: `calc(100%-${CARD_PALETTE_OFFSET}px)` }}\n    >\n      <Canvas\n        dropped={(id: string, cb: (card: C) => void) => {\n          setState(prevState => {\n            const [found, deleted] = dropDelete(id, prevState.cards);\n            cb(found);\n            return {\n              ...prevState,\n              cards: deleted\n            };\n          });\n        }}\n        addCard={(card: C) => {\n          setState(prevState => ({\n            ...prevState,\n            cards: [...prevState.cards, card]\n          }));\n        }}\n      />\n      {state.cards.map((card: C) => (\n        <Card\n          key={card.instanceid}\n          cardData={card}\n          allCards={state.cards}\n          onDrop={(parentID: string, childID: string) =>\n            setState(prevState => ({\n              ...prevState,\n              cards: putIn(prevState.cards, parentID, childID)\n            }))\n          }\n          onLift={(id: string) =>\n            setState(prevState => ({\n              ...prevState,\n              cards: lift(prevState.cards, id)\n            }))\n          }\n          onSetCoords={(dy, dx, id) => {\n            setState(prevState => {\n              const c = findInAllByID(id, prevState.cards);\n              const newcards = c.isTemplate\n                ? [\n                    ...setAllCoords(dy, dx, id, prevState.cards),\n                    createCard(c.name, c.coords.x, c.coords.y, true)\n                  ]\n                : setAllCoords(dy, dx, id, prevState.cards);\n              return {\n                ...prevState,\n                cards: newcards\n              };\n            });\n          }}\n          isUnrelated={isUnrelated}\n        />\n      ))}\n      <div\n        style={{\n          bottom: CARD_PALETTE_OFFSET,\n          position: \"fixed\",\n          width: \"100%\",\n          backgroundColor: \"rgba(255,255,255,0.5)\",\n          zIndex: 0,\n          height: CARD_HEIGHT + GUTTER_SIZE * 2\n        }}\n      />\n    </div>\n  );\n};\n\nexport default App;\n","import { useEffect, useRef } from \"react\";\n\nexport default function useInterval(callback: any, delay: any) {\n  const savedCallback = useRef();\n\n  // Remember the latest callback.\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval.\n  useEffect(() => {\n    function tick() {\n      (savedCallback as any).current();\n    }\n    if (delay !== null) {\n      let id = setInterval(tick, delay);\n      return () => clearInterval(id);\n    }\n  }, [delay]);\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}
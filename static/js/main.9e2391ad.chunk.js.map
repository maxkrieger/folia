{"version":3,"sources":["calcifer/cards/turtle.svg","Data.ts","calcifer/CardClass.ts","calcifer/ThingCard.ts","calcifer/cards/Turtle.ts","calcifer/icons/TurtleIcon.tsx","calcifer/AttributeCard.ts","calcifer/cards/Rainbow.ts","calcifer/icons/RainbowIcon.tsx","calcifer/cards/PenFollow.ts","calcifer/icons/BrushIcon.tsx","calcifer/cards/Emitter.ts","calcifer/icons/EmitterIcon.tsx","calcifer/cards/Wavy.ts","calcifer/icons/SineIcon.tsx","calcifer/CardIndex.ts","Card.tsx","calcifer/env.ts","Canvas.tsx","App.tsx","useInterval.ts","serviceWorker.ts","index.tsx"],"names":["module","exports","CardType","Card","name","id","child","this","uniqid","Thing","startMillis","Setup","p","millis","setup","world","drawableChildren","x","y","cancelled","onDragOut","setOnDragOut","cb","getHeight","windowHeight","composite","Matter","Composite","create","label","createCard","type","template","instanceid","color","hasParent","coords","isTemplate","angle","age","anyToCard","c","card","THING","ATTRIBUTE","insertLeaf","findByID","undefined","deleteByID","shiftLeafX","leaf","dx","CARD_WIDTH","GUTTER_SIZE","putIn","cards","sourceID","childID","map","find","console","error","filter","isUnrelated","id1","id2","head1","head2","lift","removed","Math","random","depth","Turtle","img","rotationInterval","rainbowMode","virtualCanvas","maxage","penMode","enable","rainbow","lastX","lastY","getEffect","nb","World","add","payload","Body","applyForce","bodies","clearInterval","rotate","bodyA","allBodies","bodyB","bodyAHeight","bounds","max","min","bodyAWidth","bodyBHeight","bodyBWidth","Constraint","pointA","pointB","length","damping","stiffness","push","setRotationInterval","window","setInterval","setAngularVelocity","randomGaussian","debugBounds","vertices","fill","beginShape","forEach","vert","vertex","endShape","CLOSE","pop","handlePen","position","colorMode","HSB","stroke","interval","strokeWeight","line","image","draw","cancel","Query","point","mouseX","mouseY","mouseIsPressed","F","Vector","setVelocity","angleMode","RADIANS","translate","tint","remove","loadImage","turtle","createGraphics","windowWidth","Bodies","circle","TurtleIcon","width","height","d","AttributeCard","Rainbow","RainbowIcon","viewBox","Pen","enableRainbow","BrushIcon","Emitter","emitInterval","radius","count","ne","bname","b","setPosition","rot","isSensor","EmitterIcon","Wavy","state","wavelength","sin","SineIcon","CardIndex","emitter","pen","wavy","StaticCard","cardData","dropping","Icon","style","backgroundColor","display","justifyContent","border","alignItems","cursor","zIndex","top","right","fontWeight","Reactable","reactable","props","getRef","onSetCoords","ond","onLift","mousedown","allCards","isSingleton","selfcontain","left","opacity","transition","transform","boxSizing","touchAction","data-card-id","ref","onDrop","React","setDropping","setMousedown","isHead","dropzone","ondragenter","ondragleave","ondrop","relatedTarget","dataset","cardId","overlap","accept","draggableElement","draggable","inertia","onend","onmove","dy","modifiers","interact","restrictRect","restriction","document","body","onDown","onUp","CARD_HEIGHT","borderRadius","Env","mouse","mouseConstraint","canvas","engine","things","windowResized","resizeCanvas","constructed","construct","addThing","walls","thing","t","t2","createCanvas","Mouse","elt","mouseParams","constraint","angularStiffness","MouseConstraint","gravity","pixelRatio","pixelDensity","rectangle","isStatic","Engine","run","watchdog","PI","collideDog","wall","collides","flat","background","Canv","theref","addCard","sk","setSk","node","p5","e","thingToCard","sub","ps","Cl","Canvas","dropped","current","setAllCoords","setCoords","App","bottomY","allcards","innerHeight","Object","keys","index","innerWidth","useState","setState","callback","delay","savedCallback","useRef","useEffect","useInterval","prevState","found","dropDelete","deleted","key","parentID","findInAllByID","bottom","onClick","location","reload","Boolean","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.9e2391ad.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/turtle.c5498b74.svg\";","import { CARD_WIDTH, GUTTER_SIZE } from \"./Card\";\nimport Thing from \"./calcifer/ThingCard\";\nimport uniqid from \"uniqid\";\nimport Card from \"./calcifer/CardClass\";\n\nexport interface ICoords {\n  x: number;\n  y: number;\n}\nexport enum CardType {\n  THING,\n  ATTRIBUTE\n}\nexport interface C {\n  name: string;\n  instanceid: string;\n  color: string;\n  child?: C;\n  hasParent: boolean;\n  coords: ICoords;\n  isTemplate: boolean;\n  angle: number;\n  age: number;\n  type: CardType;\n}\nexport const createCard = (\n  name: string,\n  x: number,\n  y: number,\n  type: CardType,\n  template = false\n): C => ({\n  name,\n  instanceid: uniqid(\"card-\"),\n  // color: \"#\" + (0x1000000 + Math.random() * 0xffffff).toString(16).substr(1, 6),\n  color: \"#000000\",\n  hasParent: false,\n  coords: { x, y },\n  isTemplate: template,\n  angle: 0,\n  age: 0,\n  type\n});\n\nexport const thingToCard = (t: Thing) => {\n  const card = createCard(\n    t.name,\n    t.composite.bodies[0].position.x,\n    t.composite.bodies[0].position.y,\n    CardType.THING\n  );\n  if (t.child) {\n    return insertLeaf(card, anyToCard(t.child));\n  }\n  return card;\n};\n\nexport const anyToCard = (c: Card): C => {\n  const card = createCard(\n    c.name,\n    0,\n    0,\n    c instanceof Thing ? CardType.THING : CardType.ATTRIBUTE\n  );\n  if (c.child) {\n    return insertLeaf(card, anyToCard(c.child));\n  }\n  return card;\n};\n\nexport const setCoords = (dy: number, dx: number, id: string, card: C): C =>\n  card.instanceid === id\n    ? {\n        ...card,\n        coords: { x: card.coords.x + dx, y: card.coords.y + dy },\n        age: 0,\n        isTemplate: false,\n        child: card.child\n          ? setCoords(dy, dx, card.child.instanceid, card.child)\n          : card.child\n      }\n    : card.child\n    ? { ...card, child: setCoords(dy, dx, id, card.child) }\n    : card;\n\nexport const findByID = (id: string, card: C): C | undefined =>\n  card.instanceid === id\n    ? card\n    : card.child\n    ? findByID(id, card.child)\n    : undefined;\n\nexport const deleteByID = (id: string, card: C): C | undefined =>\n  card.instanceid === id\n    ? undefined\n    : card.child\n    ? { ...card, child: deleteByID(id, card.child) }\n    : card;\n\nexport const findInAllByID = (id: string, cards: C[]): C => {\n  const found = cards\n    .map((card: C) => findByID(id, card))\n    .find((c: C | undefined) => c !== undefined);\n  if (found === undefined) {\n    console.error(`Cannot find card ${id}`);\n    //@ts-ignore\n    return;\n  }\n  return found;\n};\n\nexport const dropDelete = (id: string, cards: C[]): [C, C[]] => {\n  const found = cards\n    .map((card: C) => findByID(id, card))\n    .find((c: C | undefined) => c !== undefined);\n  if (found === undefined) {\n    console.error(`Cannot find card ${id}`);\n    return [cards[0], cards];\n  }\n  const deleted = cards\n    .map((card: C) => deleteByID(id, card))\n    .filter((c: C | undefined) => c !== undefined);\n  return [found, deleted as C[]];\n};\n\nexport const shiftLeafX = (leaf: C, x: number, dx: number, y: number): C => ({\n  ...leaf,\n  hasParent: true,\n  coords: { y, x },\n  child: leaf.child ? shiftLeafX(leaf.child, x + dx, dx, y) : undefined\n});\n\nexport const insertLeaf = (card: C, leaf: C): C =>\n  card.child === undefined\n    ? {\n        ...card,\n        age: 0,\n        child: shiftLeafX(\n          leaf,\n          card.coords.x + CARD_WIDTH + GUTTER_SIZE,\n          CARD_WIDTH + GUTTER_SIZE,\n          card.coords.y\n        )\n      }\n    : { ...card, child: insertLeaf(card.child, leaf) };\n\nexport const putIn = (cards: C[], sourceID: string, childID: string): C[] => {\n  const leaf = cards\n    .map((c: C) => findByID(childID, c))\n    .find((c: C | undefined) => c !== undefined);\n  if (leaf === undefined) {\n    console.error(`ASSERT: cannot find child by ID ${childID}`);\n    return cards;\n  }\n  return (cards\n    .map((card: C) => deleteByID(childID, card))\n    .filter((card: C | undefined) => card !== undefined) as C[]).map(\n    (card: C) => {\n      if (findByID(sourceID, card) !== undefined) {\n        return insertLeaf(card, leaf);\n      } else {\n        return card;\n      }\n    }\n  );\n};\n\nexport const isUnrelated = (cards: C[], id1: string, id2: string): boolean => {\n  const head1 = cards\n    .map((c: C) => findByID(id1, c))\n    .find((c: C | undefined) => c !== undefined);\n  const head2 = cards\n    .map((c: C) => findByID(id2, c))\n    .find((c: C | undefined) => c !== undefined);\n\n  if (head1 === undefined || head2 === undefined) {\n    return true;\n  }\n\n  return (\n    findByID(id1, head2) === undefined && findByID(id2, head1) === undefined\n  );\n};\n\nexport const lift = (cards: C[], id: string): C[] => {\n  const leaf = cards\n    .map((c: C) => findByID(id, c))\n    .find((c: C | undefined) => c !== undefined);\n\n  if (leaf === undefined) {\n    console.error(`ASSERT: cannot find ID ${id}`);\n    return cards;\n  }\n  const removed = cards\n    .map((card: C) => deleteByID(id, card))\n    .filter((card: C | undefined) => card !== undefined) as C[];\n  return [\n    ...removed,\n    { ...leaf, age: 0, hasParent: false, angle: Math.random() * 16 - 8 }\n  ];\n};\n\nexport const incrementAges = (cards: C[]) =>\n  cards\n    .map((card: C) => ({\n      ...card,\n      age: card.age + (card.isTemplate ? 0 : 1000)\n    }))\n    .filter((card: C) => card.isTemplate || card.age < 60000);\n\nexport const depth = (card: C): number =>\n  card.child ? depth(card.child) + 1 : 1;\n","import uniqid from \"uniqid\";\n\nexport default abstract class Card {\n  public name: string;\n  public id: string;\n  public child?: Card;\n\n  constructor(name: string) {\n    this.name = name;\n    this.id = uniqid(name);\n  }\n  public abstract cancel(): void;\n  public abstract getEffect(cb: (name: string, payload: any) => void): void;\n}\n","import Matter from \"matter-js\";\nimport Card from \"./CardClass\";\nimport p5 from \"p5\";\n\nexport default abstract class Thing extends Card {\n  constructor(name: string) {\n    super(name);\n    this.composite = Matter.Composite.create({ label: this.id });\n  }\n  protected startMillis = -1;\n\n  public Setup = () => {\n    this.startMillis = this.p.millis();\n    this.setup();\n  };\n  public abstract setup(): any;\n\n  public abstract draw(): any;\n\n  public p: p5;\n  public world: Matter.World;\n  public drawableChildren: Thing[] = [];\n  public child?: Card;\n  public x: number;\n  public y: number;\n  public cancelled = false;\n\n  public onDragOut: (t: Thing) => void = () => {};\n  public setOnDragOut = (cb: (t: Thing) => void) => {\n    this.onDragOut = cb;\n  };\n  public getHeight = () => {\n    return this.p.windowHeight * (3 / 5);\n  };\n\n  public composite: Matter.Composite;\n}\n","import * as p5 from \"p5\";\nimport Matter from \"matter-js\";\nimport Thing from \"../ThingCard\";\nimport Card from \"../CardClass\";\nimport turtle from \"./turtle.svg\";\n\nexport default class Turtle extends Thing {\n  public img: p5.Image;\n  public rotationInterval: number;\n  public rainbowMode = false;\n  public virtualCanvas: p5.Graphics;\n  public maxage = 180000;\n  public penMode: {\n    enable: boolean;\n    rainbow: boolean;\n    lastX: number;\n    lastY: number;\n  } = {\n    enable: false,\n    rainbow: false,\n    lastX: -1,\n    lastY: -1\n  };\n\n  public getEffect = (cb: (name: string, payload: any) => void) => {\n    const nb = new Turtle(this.p, this.world, this.x, this.y, this.child);\n    nb.Setup();\n    Matter.World.add(this.world, nb.composite);\n    if (nb.child) {\n      nb.child.getEffect((name: string, payload: any) => {\n        if (name === \"oscillate\") {\n          Matter.Body.applyForce(\n            nb.composite.bodies[0],\n            { x: 0, y: 0 },\n            {\n              x: 0,\n              y: 0.01 * payload\n            }\n          );\n        }\n        if (name === \"rainbow\") {\n          nb.rainbowMode = true;\n        }\n        if (name === \"pen\") {\n          nb.penMode = {\n            ...nb.penMode,\n            enable: true,\n            rainbow: payload.rainbow\n          };\n        }\n        if (name === \"wavy\") {\n          clearInterval(nb.rotationInterval);\n          Matter.Body.rotate(nb.composite.bodies[0], 0.05 * payload);\n        }\n        if (name === \"big\") {\n          //   Matter.Body.scale(\n          //     nb.composite.bodies[0],\n          //     payload / nb.radius,\n          //     payload / nb.radius\n          //   );\n          //   nb.radius = payload;\n        }\n        if (payload instanceof Thing) {\n          const bodyA = Matter.Composite.allBodies(nb.composite)[0];\n          const bodyB = Matter.Composite.allBodies(payload.composite)[0];\n          Matter.Composite.add(nb.composite, payload.composite);\n          const bodyAHeight = bodyA.bounds.max.y - bodyA.bounds.min.y,\n            bodyAWidth = bodyA.bounds.max.x - bodyA.bounds.min.x,\n            bodyBHeight = bodyB.bounds.max.y - bodyB.bounds.min.y,\n            bodyBWidth = bodyB.bounds.max.x - bodyB.bounds.min.x;\n          Matter.Composite.add(\n            nb.composite,\n            Matter.Constraint.create({\n              bodyA,\n              bodyB,\n              pointA: { x: bodyAWidth * 1, y: bodyAHeight * 0 },\n              pointB: {\n                x: bodyBWidth * -0.8,\n                y: bodyBHeight * 0\n              },\n              length: 8,\n              damping: 0.1,\n              stiffness: 0.1\n            })\n          );\n          nb.drawableChildren.push(payload);\n        }\n      });\n    }\n    cb(this.name, nb);\n  };\n\n  constructor(\n    p: p5,\n    world: Matter.World,\n\n    x: number = 0,\n    y: number = 0,\n    child?: Card\n  ) {\n    super(\"turtle\");\n    this.child = child;\n    this.x = x;\n    this.y = y;\n    this.world = world;\n    this.p = p;\n    this.img = this.p.loadImage(turtle);\n    this.virtualCanvas = this.p.createGraphics(\n      this.p.windowWidth,\n      this.getHeight()\n    );\n\n    Matter.Composite.add(\n      this.composite,\n      Matter.Bodies.circle(x, y, 25, {\n        angle: this.p.randomGaussian(0, 1)\n      })\n    );\n    this.setRotationInterval();\n  }\n\n  public setRotationInterval = () => {\n    this.rotationInterval = window.setInterval(() => {\n      Matter.Body.setAngularVelocity(\n        this.composite.bodies[0],\n        this.p.randomGaussian(0, 0.01)\n      );\n    }, this.p.randomGaussian(500, 100));\n  };\n\n  public setup = () => {};\n  public debugBounds = () => {\n    this.p.push();\n    const { vertices } = this.composite.bodies[0];\n    this.p.fill(255, 255, 255, 0.5);\n    this.p.beginShape();\n    vertices.forEach(vert => {\n      this.p.vertex(vert.x, vert.y);\n    });\n    this.p.endShape(this.p.CLOSE);\n    this.p.pop();\n  };\n  public handlePen = () => {\n    const { x, y } = this.composite.bodies[0].position;\n    if (this.penMode.lastX === -1) {\n      this.penMode.lastX = x;\n      this.penMode.lastY = y;\n    }\n    if (this.penMode.enable) {\n      const p = this.virtualCanvas;\n      p.push();\n      const interval = 5000;\n      p.colorMode(this.p.HSB, interval);\n      p.stroke(\"white\");\n      if (this.penMode.rainbow) {\n        p.stroke(\n          (this.p.millis() - this.startMillis) % interval,\n          interval / 2,\n          interval\n        );\n      }\n      p.strokeWeight(5);\n      p.line(this.penMode.lastX, this.penMode.lastY, x, y);\n      this.penMode.lastX = x;\n      this.penMode.lastY = y;\n      p.pop();\n      this.p.image(p, 0, 0);\n    }\n  };\n  public draw = () => {\n    if (this.p.millis() - this.startMillis >= this.maxage) {\n      this.cancel();\n      return;\n    }\n    const mouseover = Matter.Query.point([this.composite.bodies[0]], {\n      x: this.p.mouseX,\n      y: this.p.mouseY\n    });\n    if (\n      mouseover.length > 0 &&\n      this.p.mouseIsPressed &&\n      this.composite.bodies[0].position.y >= this.getHeight() - 50\n    ) {\n      this.onDragOut(this);\n    }\n    // this.debugBounds();\n    const F = Matter.Vector.rotate(\n      Matter.Vector.create(0, -0.5),\n      this.composite.bodies[0].angle\n    );\n    Matter.Body.setVelocity(this.composite.bodies[0], F);\n\n    this.handlePen();\n    this.p.push();\n    this.p.angleMode(this.p.RADIANS);\n    this.p.translate(\n      this.composite.bodies[0].position.x,\n      this.composite.bodies[0].position.y\n    );\n    this.p.rotate(this.composite.bodies[0].angle);\n    if (this.rainbowMode) {\n      this.p.colorMode(this.p.HSB, 1000);\n      this.p.tint((this.p.millis() - this.startMillis) % 1000, 500, 1000);\n    }\n    this.p.image(this.img, -24, -20);\n    this.p.pop();\n    this.drawableChildren.forEach(child => {\n      child.draw();\n    });\n  };\n  public cancel = () => {\n    window.clearInterval(this.rotationInterval);\n    this.cancelled = true;\n    Matter.World.remove(this.world, this.composite.bodies[0], true);\n    if (this.child) {\n      this.child.cancel();\n    }\n  };\n}\n","import * as React from \"react\";\n\nconst TurtleIcon: React.FC = ({ color }: any) => (\n  <svg width=\"48\" height=\"60\">\n    <g>\n      <g>\n        <path\n          d=\"M38,16.9199219c0-0.8457031-0.3291016-1.6411133-0.9277344-2.2392578    c-1.2333984-1.2333984-3.2431641-1.234375-4.4785156,0l-1.1982422,1.1982422    c-0.6259766-0.3295898-1.3134766-0.609375-2.0615234-0.8349609V11c0-2.9404297-2.3925781-5.3330078-5.3339844-5.3330078    c-2.9404297,0-5.3330078,2.3925781-5.3330078,5.3330078v4.043457c-0.7490234,0.2255859-1.4360352,0.5053711-2.0620117,0.8354492    l-1.1982422-1.1982422c-1.234375-1.2353516-3.2441406-1.2353516-4.4785156,0    c-1.2348633,1.2348633-1.2348633,3.2436523,0,4.4785156l1.605957,1.6064453    c-0.2363281,0.8276367-0.3676758,1.722168-0.3676758,2.6923828c0,2.2333984,0.6176758,4.6181641,1.675293,6.8027344    l-1.4995117,1.4990234c-1.2348633,1.234375-1.2348633,3.2441406,0,4.4785156    c0.6171875,0.6171875,1.4282227,0.9257812,2.2392578,0.9257812s1.6220703-0.3085938,2.2392578-0.9257812l0.8525391-0.8525391    C19.2373047,36.75,21.0478516,37.6835938,23,37.9248047v1.2421875c0,1.7460938,1.4208984,3.1669922,3.1669922,3.1669922    c0.5527344,0,1-0.4472656,1-1s-0.4472656-1-1-1C25.5234375,40.3339844,25,39.8105469,25,39.1669922v-1.2421875    c1.9521484-0.2421875,3.7626953-1.1748047,5.3271484-2.5390625l0.8525391,0.8525391    c0.6171875,0.6171875,1.4287109,0.9257812,2.2392578,0.9257812s1.6220703-0.3085938,2.2392578-0.9257812    c1.234375-1.234375,1.234375-3.2441406,0-4.4785156l-1.5-1.5c1.0566406-2.1845703,1.6748047-4.5693359,1.6748047-6.8017578    c0-0.9697266-0.1308594-1.8642578-0.3671875-2.6914062l1.6064453-1.6069336C37.6708984,18.5615234,38,17.7661133,38,16.9199219z     M33.8330078,23.4580078c0,2.1318359-0.6484375,4.4404297-1.7382812,6.4902344    c-0.03125,0.0527344-0.0693359,0.1005859-0.0908203,0.1572266c-0.6464844,1.1816406-1.4394531,2.2675781-2.3417969,3.1796875    c-0.0039062,0.0039062-0.0087891,0.0048828-0.0126953,0.0087891c-0.0048828,0.0048828-0.0058594,0.0117188-0.0107422,0.0166016    C28.0244141,34.9345703,26.0732422,36,24,36c-2.0703125,0-4.0200195-1.0625-5.6328125-2.6835938    c-0.0068359-0.0068359-0.0087891-0.0166016-0.015625-0.0234375c-0.0053711-0.0058594-0.0126953-0.0068359-0.0180664-0.0117188    c-0.9018555-0.9140625-1.6958008-2-2.3417969-3.1826172c-0.0141602-0.0371094-0.0410156-0.0683594-0.0600586-0.1044922    c-1.1054688-2.0605469-1.7651367-4.3876953-1.7651367-6.5361328c0-5.8886719,5.3476562-7.1245117,9.8334961-7.1245117    C28.4853516,16.3334961,33.8330078,17.5693359,33.8330078,23.4580078z M20.6669922,11    c0-1.8378906,1.4951172-3.3330078,3.3330078-3.3330078S27.3339844,9.1621094,27.3339844,11v3.5922852    C26.3037109,14.4272461,25.1972656,14.3334961,24,14.3334961s-2.3027344,0.0932617-3.3330078,0.2587891V11z     M12.3422852,17.7451172c-0.4550781-0.4550781-0.4550781-1.1953125,0-1.6503906s1.1953125-0.4550781,1.6503906,0    l0.925293,0.925293c-0.6040039,0.5214844-1.1225586,1.1074219-1.53125,1.7700195L12.3422852,17.7451172z M13.7563477,34.8242188    c-0.4550781-0.4550781-0.4550781-1.1953125,0-1.6503906l1.0908203-1.0908203    c0.4282227,0.6689453,0.9052734,1.296875,1.4150391,1.8857422l-0.8554688,0.8554688    C14.9516602,35.2792969,14.2114258,35.2792969,13.7563477,34.8242188z M34.2441406,33.1738281    c0.4550781,0.4550781,0.4550781,1.1953125,0,1.6503906s-1.1953125,0.4550781-1.6503906,0l-0.8564453-0.8564453    c0.5097656-0.5888672,0.9873047-1.2167969,1.4150391-1.8857422L34.2441406,33.1738281z M35.6582031,17.7451172    l-1.0449219,1.0454102c-0.4091797-0.6625977-0.9267578-1.2485352-1.53125-1.7700195l0.9257812-0.925293    c0.4550781-0.4550781,1.1953125-0.4545898,1.6503906-0.0004883C35.8789062,16.3154297,36,16.6083984,36,16.9199219    S35.8789062,17.5244141,35.6582031,17.7451172z\"\n          fill={color}\n        />\n      </g>\n    </g>\n  </svg>\n);\nexport default TurtleIcon;\n","import Card from \"./CardClass\";\nexport default abstract class AttributeCard extends Card {}\n","import AttributeCard from \"../AttributeCard\";\nimport p5 from \"p5\";\nimport Card from \"../CardClass\";\n\nexport default class Rainbow extends AttributeCard {\n  constructor(\n    p: p5,\n    world: Matter.World,\n\n    x: number = 0,\n    y: number = 0,\n    child?: Card\n  ) {\n    super(\"rainbow\");\n    this.child = child;\n  }\n  public getEffect(cb: (name: string, payload: any) => void) {\n    if (this.child) {\n      this.child.getEffect(cb);\n    }\n    cb(\"rainbow\", null);\n  }\n  public cancel() {\n    if (this.child) {\n      this.child.cancel();\n    }\n  }\n}\n","import * as React from \"react\";\n\nconst RainbowIcon = ({ color }: any) => (\n  <svg viewBox=\"0 0 100 125\" width=\"50\">\n    <g>\n      <path\n        fill={color}\n        d=\"M77.385,72.358h-5.818C69.078,62.729,60.409,55.59,50,55.59s-19.078,7.14-21.566,16.769h-5.819   C25.213,59.617,36.506,50,50,50C63.494,50,74.787,59.617,77.385,72.358z M50,38.821c-19.678,0-36.01,14.601-38.728,33.537h5.693   C19.629,56.501,33.384,44.41,50,44.41c16.615,0,30.371,12.091,33.035,27.948h5.693C86.01,53.422,69.678,38.821,50,38.821z    M50,27.642c-25.852,0-47.205,19.597-50,44.717h5.671C8.428,50.306,27.206,33.231,50,33.231c22.795,0,41.572,17.074,44.328,39.127   H100C97.205,47.238,75.852,27.642,50,27.642z\"\n      />\n    </g>\n  </svg>\n);\nexport default RainbowIcon;\n","import AttributeCard from \"../AttributeCard\";\nimport Card from \"../CardClass\";\nimport p5 from \"p5\";\n\nexport default class Pen extends AttributeCard {\n  public enableRainbow = false;\n  constructor(\n    p: p5,\n    world: Matter.World,\n\n    x: number = 0,\n    y: number = 0,\n    child?: Card\n  ) {\n    super(\"pen\");\n    this.child = child;\n  }\n  public getEffect(cb: (name: string, payload: any) => void) {\n    if (this.child) {\n      this.child.getEffect((name, payload) => {\n        if (name === \"rainbow\") {\n          this.enableRainbow = true;\n          cb(\"pen\", { rainbow: true });\n        } else {\n          cb(name, payload);\n          cb(\"pen\", { rainbow: this.enableRainbow });\n        }\n      });\n    } else {\n      cb(\"pen\", { rainbow: false });\n    }\n  }\n  public cancel() {\n    if (this.child) {\n      this.child.cancel();\n    }\n  }\n}\n","import * as React from \"react\";\nconst BrushIcon = ({ color }: any) => (\n  <svg viewBox=\"0 0 24 30\" width=\"36\">\n    <g>\n      <path\n        d=\"M3.5,17.2c-0.6,0.6-0.8,1.3-1.1,2c-0.3,1-0.6,1.8-1.9,2.2c-0.3,0.1-0.4,0.4-0.4,0.6c0,0.3,0.2,0.5,0.5,0.6   c1,0.3,1.9,0.4,2.8,0.4c2.1,0,3.6-0.7,4.4-1.5c0.6-0.6,0.9-1.3,0.9-2.1s-0.3-1.6-0.9-2.1C6.6,16,4.6,16,3.5,17.2z M6.8,20.5   c-0.7,0.7-2.2,1.3-4.3,1.1c0.6-0.6,0.9-1.4,1.1-2.1C3.8,19,4,18.4,4.4,18.1c0,0,0,0,0,0c0.7-0.7,1.8-0.7,2.5,0   c0.3,0.3,0.5,0.8,0.5,1.2C7.3,19.8,7.2,20.2,6.8,20.5z\"\n        fill={color}\n      />\n      <path\n        d=\"M23.7,1.3c-0.5-0.5-1-1-8.4,5c-3.4,2.8-7,6-7.5,6.5c-0.6,0.6-0.9,1.3-0.9,2.1c0,0.8,0.3,1.6,0.9,2.1   C8.4,17.7,9.2,18,9.9,18c0.8,0,1.6-0.3,2.1-0.9c0.5-0.5,3.7-4.1,6.5-7.5C24.7,2.3,24.2,1.7,23.7,1.3z M8.7,16.2   c-0.3-0.3-0.5-0.8-0.5-1.2c0-0.5,0.2-0.9,0.5-1.2c0.1-0.1,0.3-0.3,0.5-0.4c0.9,0.6,1.8,1.5,2.4,2.4c-0.2,0.2-0.3,0.4-0.4,0.5   C10.5,16.9,9.4,16.9,8.7,16.2z M12.5,14.8c-0.6-0.9-1.5-1.7-2.3-2.3c3.1-2.7,9.6-8.3,12.1-9.7C20.8,5.2,15.2,11.7,12.5,14.8z\"\n        fill={color}\n      />\n    </g>\n  </svg>\n);\nexport default BrushIcon;\n","import Thing from \"../ThingCard\";\nimport p5 from \"p5\";\nimport Card from \"../CardClass\";\nimport Matter from \"matter-js\";\n\nexport default class Emitter extends Thing {\n  public emitInterval: number;\n  public radius = 10;\n  public count = 20;\n  public maxage = 50000;\n  public rainbowMode = false;\n  constructor(\n    p: p5,\n    world: Matter.World,\n\n    x: number = 0,\n    y: number = 0,\n    child?: Card\n  ) {\n    super(\"emitter\");\n    this.x = x;\n    this.y = y;\n    this.p = p;\n    this.world = world;\n    this.child = child;\n    Matter.Composite.add(\n      this.composite,\n      Matter.Bodies.circle(x, y, this.radius / 2, {\n        isSensor: true\n      })\n    );\n  }\n  public cancel = () => {\n    this.cancelled = true;\n    window.clearInterval(this.emitInterval);\n    this.drawableChildren.forEach(child => {\n      Matter.Composite.remove(child.world, child.composite.bodies[0]);\n    });\n    if (this.child) {\n      this.child.cancel();\n    }\n    this.drawableChildren = [];\n    Matter.Composite.remove(this.world, this.composite.bodies[0]);\n  };\n  public getEffect = (cb: (name: string, payload: any) => void) => {\n    const ne = new Emitter(this.p, this.world, this.x, this.y, this.child);\n    ne.Setup();\n    Matter.World.add(this.world, ne.composite);\n    if (ne.child) {\n      ne.child.getEffect((name: string, payload: any) => {\n        if (name === \"wavy\") {\n          Matter.Body.rotate(ne.composite.bodies[0], 0.05 * payload);\n          const F = Matter.Vector.rotate(\n            Matter.Vector.create(0, -0.5),\n            ne.composite.bodies[0].angle\n          );\n          Matter.Body.setVelocity(ne.composite.bodies[0], F);\n        }\n        if (name === \"rainbow\") {\n          ne.rainbowMode = true;\n        }\n        if (payload instanceof Thing) {\n          ne.emitInterval = window.setInterval(() => {\n            // if (ne.drawableChildren.length > 20) {\n            //   ne.drawableChildren[0].cancel();\n            //   Matter.Composite.remove(ne.composite, ne.composite.composites[1]);\n            //   ne.drawableChildren.shift();\n            // }\n            if (ne.count > 0) {\n              ne.count--;\n              const { x, y } = ne.composite.bodies[0].position;\n              payload.getEffect((bname, b) => {\n                if (b.name === ne.name) {\n                  // prevent emitters-of-emitters\n                  return;\n                }\n                Matter.Body.setPosition(b.composite.bodies[0], { x, y });\n                const rot = this.p.randomGaussian(0, 1);\n\n                Matter.Body.applyForce(\n                  b.composite.bodies[0],\n                  {\n                    x: b.composite.bodies[0].position.x,\n                    y: b.composite.bodies[0].position.y\n                  },\n                  Matter.Vector.rotate({ x: 0, y: -0.1 }, rot)\n                );\n                Matter.Body.rotate(b.composite.bodies[0], rot);\n                Matter.Composite.add(ne.composite, b.composite);\n                ne.drawableChildren.push(b);\n              });\n            }\n          }, this.p.randomGaussian(900, 100));\n        }\n      });\n    }\n\n    cb(this.name, ne);\n  };\n  public draw = () => {\n    const mouseover = Matter.Query.point([this.composite.bodies[0]], {\n      x: this.p.mouseX,\n      y: this.p.mouseY\n    });\n    if (\n      mouseover.length > 0 &&\n      this.p.mouseIsPressed &&\n      this.composite.bodies[0].position.y >= this.getHeight() - 50\n    ) {\n      this.onDragOut(this);\n    }\n    if (this.p.millis() - this.startMillis >= this.maxage) {\n      this.cancel();\n      return;\n    }\n    this.p.push();\n    const interval = 5000;\n    this.p.colorMode(this.p.HSB, interval);\n    this.p.fill(\"white\");\n    if (this.rainbowMode) {\n      this.p.fill(\n        (this.p.millis() - this.startMillis) % interval,\n        interval / 2,\n        interval\n      );\n    }\n\n    this.p.circle(\n      this.composite.bodies[0].position.x,\n      this.composite.bodies[0].position.y,\n      this.radius\n    );\n    this.p.pop();\n    this.drawableChildren.forEach(child => {\n      child.draw();\n    });\n  };\n  public setup = () => {};\n}\n","import * as React from \"react\";\nconst EmitterIcon = ({ color }: any) => (\n  <svg viewBox=\"0 0 108.777 140.71\" width=\"50\">\n    <g>\n      <g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M54.388,86.653c-13.364,0-24.237-10.873-24.237-24.236c0-13.365,10.873-24.238,24.237-24.238     c13.365,0,24.238,10.873,24.238,24.238C78.626,75.78,67.753,86.653,54.388,86.653z M54.388,43.179     c-10.607,0-19.237,8.63-19.237,19.238c0,10.607,8.63,19.236,19.237,19.236s19.238-8.629,19.238-19.236     C73.626,51.809,64.995,43.179,54.388,43.179z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M54.389,43.179c-1.381,0-2.5-1.119-2.5-2.5V2.5c0-1.381,1.119-2.5,2.5-2.5s2.5,1.119,2.5,2.5v38.179     C56.889,42.06,55.77,43.179,54.389,43.179z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M43.522,46.091c-0.864,0-1.704-0.447-2.167-1.25l-16.95-29.359c-0.69-1.195-0.281-2.725,0.915-3.414     c1.196-0.693,2.725-0.281,3.415,0.914l16.95,29.359c0.69,1.195,0.28,2.725-0.915,3.415     C44.377,45.983,43.946,46.091,43.522,46.091z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M35.562,54.048c-0.424,0-0.854-0.108-1.247-0.336L15.49,42.844c-1.196-0.69-1.605-2.22-0.915-3.415     c0.689-1.195,2.218-1.607,3.415-0.915l18.824,10.868c1.195,0.69,1.605,2.219,0.915,3.415     C37.267,53.599,36.426,54.048,35.562,54.048z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M19.031,64.915c-1.381,0-2.5-1.119-2.5-2.5s1.119-2.5,2.5-2.5h13.621c1.381,0,2.5,1.119,2.5,2.5     s-1.119,2.5-2.5,2.5H19.031z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M2.503,94.874c-0.864,0-1.704-0.447-2.167-1.25c-0.69-1.195-0.281-2.724,0.915-3.416l33.063-19.09     c1.194-0.691,2.725-0.281,3.415,0.915s0.28,2.725-0.915,3.415L3.751,94.538C3.357,94.766,2.927,94.874,2.503,94.874z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M26.874,112.569c-0.424,0-0.854-0.109-1.247-0.336c-1.196-0.691-1.605-2.219-0.915-3.416l16.644-28.828     c0.689-1.195,2.218-1.607,3.415-0.915c1.195,0.69,1.605,2.22,0.915,3.415l-16.644,28.828     C28.579,112.12,27.738,112.569,26.874,112.569z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M54.39,110.141c-1.381,0-2.5-1.119-2.5-2.5l-0.001-23.49c0-1.381,1.119-2.5,2.5-2.5     c1.38,0,2.5,1.119,2.5,2.5l0.001,23.49C56.89,109.022,55.771,110.141,54.39,110.141z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M81.116,111.206c-0.864,0-1.704-0.449-2.167-1.252L63.092,82.489c-0.69-1.195-0.281-2.725,0.915-3.415     c1.195-0.692,2.725-0.281,3.415,0.915l15.857,27.464c0.69,1.197,0.28,2.725-0.915,3.416     C81.971,111.096,81.54,111.206,81.116,111.206z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M84.665,82.397c-0.424,0-0.854-0.108-1.247-0.336l-11.455-6.613c-1.196-0.69-1.605-2.219-0.915-3.415     c0.688-1.195,2.218-1.607,3.415-0.915l11.455,6.613c1.195,0.69,1.605,2.219,0.915,3.415     C86.37,81.948,85.529,82.397,84.665,82.397z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M76.125,64.915c-1.381,0-2.5-1.119-2.5-2.5s1.119-2.5,2.5-2.5h29.055c1.381,0,2.5,1.119,2.5,2.5     s-1.119,2.5-2.5,2.5H76.125z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M73.215,54.048c-0.864,0-1.704-0.449-2.167-1.251c-0.69-1.196-0.281-2.725,0.915-3.415l33.064-19.091     c1.196-0.69,2.725-0.28,3.415,0.915s0.28,2.725-0.915,3.415L74.463,53.712C74.069,53.938,73.639,54.048,73.215,54.048z\"\n          />\n        </g>\n        <g>\n          <path\n            fill=\"#000000\"\n            d=\"M65.254,46.091c-0.424,0-0.854-0.107-1.247-0.335c-1.196-0.69-1.605-2.22-0.915-3.415l12.701-22.002     c0.689-1.195,2.217-1.607,3.415-0.914c1.195,0.689,1.605,2.219,0.915,3.414L67.422,44.841     C66.959,45.643,66.118,46.091,65.254,46.091z\"\n          />\n        </g>\n      </g>\n    </g>\n  </svg>\n);\nexport default EmitterIcon;\n","import AttributeCard from \"../AttributeCard\";\nimport p5 from \"p5\";\nimport Card from \"../CardClass\";\nexport default class Wavy extends AttributeCard {\n  public interval: number;\n  public state = 0;\n  public p: p5;\n  constructor(\n    p: p5,\n    world: Matter.World,\n\n    x: number = 0,\n    y: number = 0,\n    child?: Card\n  ) {\n    super(\"wavy\");\n    this.child = child;\n    this.p = p;\n  }\n  public getEffect(cb: (name: string, payload: any) => void) {\n    if (this.child) {\n      this.child.getEffect(cb);\n    }\n    const wavelength = 0.5 + this.p.randomGaussian(0, 0.2);\n    this.interval = window.setInterval(() => {\n      this.state += 0.1;\n      cb(\"wavy\", Math.sin(wavelength * this.state));\n    }, 50);\n  }\n  public cancel() {\n    window.clearInterval(this.interval);\n    if (this.child) {\n      this.child.cancel();\n    }\n  }\n}\n","import * as React from \"react\";\nconst SineIcon = ({ color }: any) => (\n  <svg viewBox=\"0 0 100 125\" width=\"50\">\n    <path d=\"M74.46,86q-.44,0-.87,0c-7.3-.6-13-8.67-16.57-15.33-2.26-4.26-4.19-10.54-6.25-17.18-4.55-14.72-10.21-33-22-36.79C19.51,13.68,13,24.2,8.4,33.69A139.25,139.25,0,0,0,2,50.21a1,1,0,0,1-2-.66A140.86,140.86,0,0,1,6.55,32.79c3.2-6.58,10.71-22,22.84-18.14C42.22,18.72,47.81,36.82,52.74,52.8c2,6.55,3.93,12.74,6.1,16.83,3.29,6.21,8.54,13.72,14.92,14.24,3.18.26,6.42-1.29,9.65-4.61,7-7.25,10.72-18.21,13.68-27,.28-.84.58-1.77.9-2.77a1,1,0,1,1,2,.62c-.32,1-.62,1.95-.91,2.8-2.87,8.53-6.8,20.22-14.16,27.8C81.49,84.19,78,86,74.46,86Z\" />\n  </svg>\n);\n\nexport default SineIcon;\n","import Turtle from \"./cards/Turtle\";\n// import Ball from \"./cards/Particle\";\n// import Duck from \"./icons/Duck\";\nimport TurtleIcon from \"./icons/TurtleIcon\";\nimport Rainbow from \"./cards/Rainbow\";\nimport RainbowIcon from \"./icons/RainbowIcon\";\nimport Pen from \"./cards/PenFollow\";\nimport BrushIcon from \"./icons/BrushIcon\";\nimport Emitter from \"./cards/Emitter\";\nimport EmitterIcon from \"./icons/EmitterIcon\";\nimport Wavy from \"./cards/Wavy\";\nimport SineIcon from \"./icons/SineIcon\";\nimport { CardType } from \"../Data\";\n\nconst CardIndex = {\n  turtle: [Turtle, TurtleIcon, CardType.THING],\n  // ball: [Ball, Duck],\n  emitter: [Emitter, EmitterIcon, CardType.THING],\n  rainbow: [Rainbow, RainbowIcon, CardType.ATTRIBUTE],\n  pen: [Pen, BrushIcon, CardType.ATTRIBUTE],\n  wavy: [Wavy, SineIcon, CardType.ATTRIBUTE]\n} as any;\nexport default CardIndex;\n","import * as React from \"react\";\nimport reactable from \"reactablejs\";\nimport { C, depth, shiftLeafX, CardType } from \"./Data\";\nimport interact from \"interactjs\";\nimport CardIndex from \"./calcifer/CardIndex\";\n\nexport const CARD_WIDTH = 165 / 2;\n\nexport const CARD_HEIGHT = 230 / 2;\n\nexport const GUTTER_SIZE = 10;\n\ninterface ISCProps {\n  getRef: any;\n  x: number;\n  y: number;\n  angle: number;\n  dropping: boolean;\n  cardData: C;\n  allCards: C[];\n  mousedown: boolean;\n  onSetCoords(dy: number, dx: number, id: string): void;\n  ond(parent: string, child: string): void;\n  onLift(id: string): void;\n  isUnrelated(isUnrelated: C[], id1: string, id2: string): boolean;\n}\n\nconst StaticCard: React.FC<any> = ({ cardData, dropping }: any) => {\n  const Icon = CardIndex[cardData.name][1];\n  return (\n    <div\n      style={{\n        width: CARD_WIDTH,\n        height: CARD_HEIGHT,\n        backgroundColor: dropping ? \"#6BCAFF\" : \"#FFFFFF\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        border: \"1px solid black\",\n        alignItems: \"center\",\n        cursor: \"grab\",\n        zIndex: 10,\n        position: \"relative\"\n      }}\n    >\n      <span\n        style={{ position: \"absolute\", top: 2, right: 5, fontWeight: \"bold\" }}\n      >\n        {cardData.type === CardType.ATTRIBUTE ? \"A\" : \"T\"}\n      </span>\n      <Icon color={cardData.color} />\n    </div>\n  );\n};\n\nconst SC: React.FC<ISCProps> = (props: ISCProps) => {\n  const {\n    getRef,\n    x,\n    y,\n    dropping,\n    cardData,\n    onSetCoords,\n    ond,\n    onLift,\n    mousedown,\n    isUnrelated,\n    allCards\n  } = props;\n\n  const c = <StaticCard cardData={cardData} dropping={dropping} />;\n  const isSingleton = cardData.child === undefined && !cardData.hasParent;\n  const selfcontain = (\n    <div\n      style={{\n        position: \"absolute\",\n        left: x,\n        top: y,\n        opacity: mousedown ? 0.5 : 1,\n        transition: \"opacity 0.25s, transform 0.25s\",\n        transform: `rotate(${isSingleton ? cardData.angle : 0}deg)`,\n        boxSizing: \"border-box\",\n        touchAction: \"none\",\n        zIndex: mousedown ? 1000 : 10\n      }}\n      data-card-id={cardData.instanceid}\n      ref={getRef}\n    >\n      {c}\n    </div>\n  );\n  if (!cardData.child) {\n    return selfcontain;\n  }\n  const child = (\n    <Card\n      cardData={\n        mousedown\n          ? shiftLeafX(\n              cardData.child,\n              cardData.coords.x + CARD_WIDTH / 5,\n              CARD_WIDTH / 5,\n              cardData.coords.y\n            )\n          : cardData.child\n      }\n      allCards={allCards}\n      onSetCoords={onSetCoords}\n      onDrop={ond}\n      onLift={onLift}\n      isUnrelated={isUnrelated}\n    />\n  );\n  return (\n    <>\n      {selfcontain}\n      {child}\n    </>\n  );\n};\n\ninterface ICardProps {\n  cardData: C;\n  allCards: C[];\n  onSetCoords(dy: number, dx: number, id: string): void;\n  onDrop(parent: string, child: string): void;\n  onLift(id: string): void;\n  isUnrelated(cards: C[], id1: string, id2: string): boolean;\n}\n\nconst Reactable = reactable(SC);\n\nconst Card: React.FC<ICardProps> = ({\n  cardData,\n  onSetCoords,\n  onDrop,\n  onLift,\n  isUnrelated,\n  allCards\n}: ICardProps) => {\n  const [dropping, setDropping] = React.useState(false);\n\n  const [mousedown, setMousedown] = React.useState(false);\n  const isHead = cardData.child !== undefined && !cardData.hasParent;\n\n  // This doesn't actually help since reactable's a HOC\n  const dropzone = React.useMemo(\n    () => ({\n      ondragenter: () => setDropping(true),\n      ondragleave: () => setDropping(false),\n      ondrop: ({ relatedTarget }: any) => {\n        onDrop(cardData.instanceid, relatedTarget.dataset.cardId);\n        setDropping(false);\n      },\n      overlap: 0.1,\n      accept: ({ dropzone, draggableElement }: any) => {\n        if (draggableElement.dataset.cardId) {\n          return (\n            isUnrelated(\n              allCards,\n              cardData.instanceid,\n              draggableElement.dataset.cardId as string\n            ) && cardData.instanceid !== draggableElement.dataset.cardId\n          );\n        } else return false;\n      }\n    }),\n    [allCards, cardData.instanceid, isUnrelated, onDrop]\n  );\n\n  const c = (\n    <Reactable\n      draggable={\n        {\n          inertia: true,\n          onend: () => onLift(cardData.instanceid),\n          onmove: ({ dy, dx }: any) => onSetCoords(dy, dx, cardData.instanceid),\n          modifiers: [\n            interact.modifiers.restrictRect({\n              restriction: document.body\n            })\n          ]\n        } as any\n      }\n      dropzone={dropzone}\n      dropping={dropping}\n      onDown={() => {\n        setMousedown(true);\n      }}\n      onUp={() => {\n        setMousedown(false);\n      }}\n      mousedown={mousedown}\n      cardData={cardData}\n      onSetCoords={onSetCoords}\n      onLift={onLift}\n      ond={onDrop}\n      allCards={allCards}\n      isUnrelated={isUnrelated}\n      {...cardData.coords}\n    />\n  );\n  return (\n    <>\n      <div\n        style={{\n          display: isHead && !mousedown ? \"initial\" : \"none\",\n          position: \"absolute\",\n          width: depth(cardData) * (CARD_WIDTH + GUTTER_SIZE) + GUTTER_SIZE,\n          height: CARD_HEIGHT + 20,\n          left: cardData.coords.x - GUTTER_SIZE,\n          top: cardData.coords.y - GUTTER_SIZE,\n          backgroundColor: \"tan\",\n          borderRadius: \"10px\",\n          zIndex: 10\n        }}\n      />\n      {c}\n    </>\n  );\n};\n\nexport { Card, StaticCard };\n","import * as p5 from \"p5\";\nimport Matter from \"matter-js\";\nimport Thing from \"./ThingCard\";\nimport { C } from \"../Data\";\nimport CardIndex from \"./CardIndex\";\nimport Card from \"./CardClass\";\n\nconst WALL_SIZE = 70;\n\nexport default class Env {\n  public mouse: Matter.Mouse;\n  public mouseConstraint: Matter.MouseConstraint;\n  public canvas: p5.Renderer;\n  public p: p5;\n  public engine: Matter.Engine;\n  public onDragOut: (t: Thing) => void;\n  public rainbowMode = false;\n  public penMode: {\n    enable: boolean;\n    rainbow: boolean;\n    lastX: number;\n    lastY: number;\n  } = {\n    enable: false,\n    rainbow: false,\n    lastX: -1,\n    lastY: -1\n  };\n  public startMillis = 0;\n\n  public things: Thing[] = [];\n\n  constructor(p: p5, onDragOut: (t: Thing) => void) {\n    this.p = p;\n    this.p.setup = this.Setup;\n    this.p.windowResized = this.windowResized;\n    this.p.draw = this.draw;\n    this.engine = Matter.Engine.create();\n    this.onDragOut = onDragOut;\n    // this.p.preload = this.preload;\n  }\n  public windowResized = () => {\n    this.p.resizeCanvas(this.p.windowWidth, this.getHeight());\n  };\n  public onDrop = (card: C) => {\n    const constructed = this.construct(card);\n    if (constructed instanceof Thing) {\n      this.addThing(constructed);\n    } else {\n      constructed.getEffect((name, payload) => {\n        if (name === \"rainbow\") {\n          this.rainbowMode = !this.rainbowMode;\n        } else if (name === \"pen\") {\n          this.penMode = {\n            lastX: card.coords.x,\n            lastY: card.coords.y,\n            enable: true,\n            rainbow: payload.rainbow\n          };\n        }\n      });\n      // Env-wide attrs or x/y placeholder\n    }\n  };\n  public construct = (card: C): Card => {\n    // NOTE: coords.x/y are card specific\n    return new CardIndex[card.name][0](\n      this.p,\n      this.engine.world,\n      card.coords.x,\n      card.coords.y,\n      card.child ? this.construct(card.child) : undefined\n    );\n  };\n\n  public walls: Matter.Body[];\n  public addThing = (thing: Thing) => {\n    thing.Setup();\n    thing.getEffect((name, payload) => {\n      payload.setOnDragOut((t: Thing) => {\n        this.things = this.things.filter((t2: Thing) => t2.id !== t.id);\n        this.onDragOut(t);\n      });\n      this.things.push(payload);\n    });\n  };\n  public Setup = () => {\n    this.canvas = this.p.createCanvas(this.p.windowWidth, this.getHeight());\n    this.mouse = Matter.Mouse.create(this.canvas.elt);\n    const mouseParams = {\n      mouse: this.mouse,\n      constraint: {\n        stiffness: 0.1,\n        angularStiffness: 0.95\n      } as any\n    };\n    this.mouseConstraint = Matter.MouseConstraint.create(\n      this.engine,\n      mouseParams\n    );\n    this.engine.world.gravity.y = 0;\n\n    this.startMillis = this.p.millis();\n    this.mouseConstraint.mouse.pixelRatio = this.p.pixelDensity();\n    Matter.World.add(this.engine.world, this.mouseConstraint);\n    this.walls = [\n      Matter.Bodies.rectangle(\n        0,\n        this.getHeight() + WALL_SIZE,\n        this.p.windowWidth,\n        WALL_SIZE,\n        { isStatic: true }\n      ),\n      Matter.Bodies.rectangle(0, -WALL_SIZE, this.p.windowWidth, WALL_SIZE, {\n        isStatic: true\n      }),\n      Matter.Bodies.rectangle(-WALL_SIZE, 0, WALL_SIZE, this.getHeight(), {\n        isStatic: true\n      }),\n      Matter.Bodies.rectangle(\n        this.p.windowWidth,\n        0,\n        WALL_SIZE,\n        this.getHeight(),\n        {\n          isStatic: true\n        }\n      )\n    ];\n    Matter.World.add(this.engine.world, this.walls);\n    Matter.Engine.run(this.engine);\n  };\n  public watchdog = () => {\n    Matter.Composite.allBodies(this.engine.world).forEach(body => {\n      const { x, y } = body.position;\n      if (!body.isStatic) {\n        if (x < 0) {\n          body.position.x = 0;\n          Matter.Body.rotate(body, Math.PI);\n        } else if (x > this.p.windowWidth) {\n          body.position.x = this.p.windowWidth - 50;\n          Matter.Body.rotate(body, Math.PI);\n        } else if (y < 0) {\n          body.position.y = 0;\n          Matter.Body.rotate(body, Math.PI);\n        } else if (y > this.getHeight()) {\n          body.position.y = this.getHeight() - 50;\n          Matter.Body.rotate(body, Math.PI);\n        }\n      }\n    });\n  };\n  public collideDog = () => {\n    const colls = this.walls.map((wall: any) =>\n      (Matter.Query as any).collides(\n        wall,\n        Matter.Composite.allBodies(this.engine.world)\n      )\n    );\n    const fl = colls.flat();\n    fl.forEach(({ bodyB, bodyA }: any) => {\n      if (!bodyB.isStatic) {\n        Matter.Body.rotate(bodyB, Math.PI);\n      }\n      if (!bodyA.isStatic) {\n        Matter.Body.rotate(bodyA, Math.PI);\n      }\n    });\n  };\n  public getHeight = () => {\n    return this.p.windowHeight * (3 / 5);\n  };\n  public draw = () => {\n    // Matter.Engine.update(this.engine);\n    this.things = this.things.filter(thing => !thing.cancelled);\n    this.things.forEach(this.watchdog);\n    this.collideDog();\n\n    if (this.rainbowMode) {\n      this.p.colorMode(this.p.HSB, 1000);\n      this.p.background((this.p.millis() - this.startMillis) % 1000, 500, 400);\n    } else {\n      this.p.background(\"#322931\");\n    }\n    if (this.penMode.enable) {\n      const interval = 5000;\n      this.p.push();\n      this.p.colorMode(this.p.HSB, interval);\n      this.p.fill(\"white\");\n      if (this.penMode.rainbow) {\n        this.p.fill(\n          (this.p.millis() - this.startMillis) % interval,\n          interval / 2,\n          interval\n        );\n      }\n      this.p.circle(this.penMode.lastX, this.penMode.lastY, 10);\n      this.p.pop();\n    }\n    this.things.forEach(t => {\n      t.draw();\n    });\n  };\n}\n","import * as React from \"react\";\nimport p5 from \"p5\";\nimport Env from \"./calcifer/env\";\nimport reactable from \"reactablejs\";\nimport { C, thingToCard } from \"./Data\";\nimport { CARD_WIDTH, CARD_HEIGHT } from \"./Card\";\nimport Thing from \"./calcifer/ThingCard\";\n\nconst Canv = ({ getRef, theref, addCard }: any) => {\n  const [sk, setSk] = React.useState<any>(null);\n  React.useImperativeHandle(theref, () => ({\n    onDrop(card: C) {\n      sk.onDrop({\n        ...card,\n        coords: {\n          x: card.coords.x + CARD_WIDTH / 2,\n          y: card.coords.y + CARD_HEIGHT / 2\n        }\n      });\n    }\n  }));\n  const ref = React.useCallback((node: any) => {\n    if (node !== null) {\n      const sketch = (p: p5) => {\n        const e = new Env(p, (t: Thing) => {\n          addCard(thingToCard(t));\n        });\n        setSk(e);\n        return e;\n      };\n      new p5(sketch, node);\n    }\n    // Im sorry\n    // eslint-disable-next-line\n  }, []);\n\n  return (\n    <div ref={getRef}>\n      <div ref={ref} />\n    </div>\n  );\n};\n\n// use `as any` to coerce\nconst Reactable = React.forwardRef((props: any, ref: any) => {\n  const sub: React.FC = React.useMemo(\n    () => (ps: any) => <Canv ref={ref} {...ps} />,\n    [ref]\n  );\n  const Cl = React.useMemo(() => reactable(sub), [sub]);\n  return <Cl {...props} />;\n});\n\ninterface IProps {\n  dropped(id: string, cb: (card: C) => void): void;\n  addCard(card: C): void;\n}\n\nconst Canvas: React.FC<IProps> = ({ dropped, addCard }: IProps) => {\n  const ref = React.useRef<any>();\n  return (\n    <Reactable\n      dropzone={\n        {\n          accept: ({ dropzone, draggableElement }) => {\n            if (draggableElement.dataset.cardId) {\n              return true;\n            } else return false;\n          },\n          ondrop: ({ relatedTarget }) => {\n            dropped(relatedTarget.dataset.cardId, (c: C) => {\n              if (ref && ref.current) {\n                ref.current.onDrop(c);\n              }\n            });\n          },\n          overlap: 0.5\n        } as Interact.DropzoneOptions\n      }\n      theref={ref}\n      addCard={addCard}\n    />\n  );\n};\n\nexport default Canvas;\n","import React, { useState } from \"react\";\nimport { Card, CARD_WIDTH, CARD_HEIGHT, GUTTER_SIZE } from \"./Card\";\nimport {\n  C,\n  setCoords,\n  putIn,\n  lift,\n  isUnrelated,\n  dropDelete,\n  findInAllByID,\n  createCard,\n  incrementAges\n} from \"./Data\";\nimport Canvas from \"./Canvas\";\nimport CardIndex from \"./calcifer/CardIndex\";\nimport useInterval from \"./useInterval\";\n\nexport const CARD_PALETTE_OFFSET = 50;\n\ninterface IState {\n  cards: C[];\n}\n\nconst setAllCoords = (dy: number, dx: number, id: string, cards: C[]) =>\n  cards.map((card: C) => setCoords(dy, dx, id, card));\n\nconst allCards = (bottomY: number) =>\n  Object.keys(CardIndex).map((name: string, index: number) =>\n    createCard(\n      name,\n      window.innerWidth / 2 -\n        ((CARD_WIDTH + GUTTER_SIZE) * Object.keys(CardIndex).length) / 2 +\n        (CARD_WIDTH + GUTTER_SIZE) * index +\n        GUTTER_SIZE,\n      bottomY,\n      CardIndex[name][2],\n      true\n    )\n  );\n\nconst App: React.FC = () => {\n  const allcards = allCards(\n    window.innerHeight - CARD_HEIGHT - GUTTER_SIZE - CARD_PALETTE_OFFSET\n  );\n  const [state, setState] = useState<IState>({\n    cards: allcards\n  });\n\n  useInterval(() => {\n    setState({ ...state, cards: incrementAges(state.cards) });\n  }, 1000);\n\n  return (\n    <div\n      style={{ width: \"100%\", height: `calc(100%-${CARD_PALETTE_OFFSET}px)` }}\n    >\n      <Canvas\n        dropped={(id: string, cb: (card: C) => void) => {\n          setState(prevState => {\n            const [found, deleted] = dropDelete(id, prevState.cards);\n            cb(found);\n            return {\n              ...prevState,\n              cards: deleted\n            };\n          });\n        }}\n        addCard={(card: C) => {\n          setState(prevState => ({\n            ...prevState,\n            cards: [...prevState.cards, card]\n          }));\n        }}\n      />\n      {state.cards.map((card: C) => (\n        <Card\n          key={card.instanceid}\n          cardData={card}\n          allCards={state.cards}\n          onDrop={(parentID: string, childID: string) =>\n            setState(prevState => ({\n              ...prevState,\n              cards: putIn(prevState.cards, parentID, childID)\n            }))\n          }\n          onLift={(id: string) =>\n            setState(prevState => ({\n              ...prevState,\n              cards: lift(prevState.cards, id)\n            }))\n          }\n          onSetCoords={(dy, dx, id) => {\n            setState(prevState => {\n              const c = findInAllByID(id, prevState.cards);\n              const newcards = c.isTemplate\n                ? [\n                    ...setAllCoords(dy, dx, id, prevState.cards),\n                    createCard(c.name, c.coords.x, c.coords.y, c.type, true)\n                  ]\n                : setAllCoords(dy, dx, id, prevState.cards);\n              return {\n                ...prevState,\n                cards: newcards\n              };\n            });\n          }}\n          isUnrelated={isUnrelated}\n        />\n      ))}\n      <div\n        style={{\n          bottom: CARD_PALETTE_OFFSET,\n          position: \"fixed\",\n          width: \"100%\",\n          backgroundColor: \"rgba(255,255,255,0.5)\",\n          zIndex: 0,\n          height: CARD_HEIGHT + GUTTER_SIZE * 2\n        }}\n      />\n      <button\n        style={{ position: \"absolute\", bottom: 0, left: 0 }}\n        onClick={() => window.location.reload()}\n      >\n        reset\n      </button>\n    </div>\n  );\n};\n\nexport default App;\n","import { useEffect, useRef } from \"react\";\n\nexport default function useInterval(callback: any, delay: any) {\n  const savedCallback = useRef();\n\n  // Remember the latest callback.\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval.\n  useEffect(() => {\n    function tick() {\n      (savedCallback as any).current();\n    }\n    if (delay !== null) {\n      let id = setInterval(tick, delay);\n      return () => clearInterval(id);\n    }\n  }, [delay]);\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}